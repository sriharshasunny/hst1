<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foodie Haven - Restaurant Discovery</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style1.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='payment-responsive.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='bills-style.css') }}">
    <style>
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0px); }
        }

        .checkout-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #ff4757, #ff6b81);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            animation: float 3s ease-in-out infinite;
        }

        .checkout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.3);
            animation: pulse 1.5s infinite;
        }

        .checkout-btn:active {
            transform: scale(0.98);
        }

        .checkout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, #ff6b81, #ff4757);
            background-size: 200% 200%;
            animation: gradientBG 3s ease infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .checkout-btn:hover::before {
            opacity: 1;
        }

        .checkout-btn span {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .checkout-btn i {
            font-size: 20px;
            transition: transform 0.3s ease;
        }

        .checkout-btn:hover i {
            transform: translateX(5px);
        }

        .payment-modal-content {
            background: #fff;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            margin: 20px auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.5s ease-out;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 24px;
            color: #333;
        }

        .close-modal {
            background: none;
            border: none;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #ff4757;
        }

        .modal-body {
            padding: 20px;
        }

        .order-summary {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .order-summary h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
        }

        #payment-order-items {
            margin-bottom: 15px;
        }

        .order-totals {
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        .payment-options {
            margin-top: 20px;
        }

        .payment-options h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 18px;
        }

        .payment-method-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-method {
            background: #fff;
            border: 2px solid #eee;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .payment-method:hover {
            border-color: #ff4757;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.1);
        }

        .payment-method.selected {
            border-color: #ff4757;
            background: rgba(255, 71, 87, 0.05);
        }

        .payment-method input[type="radio"] {
            display: none;
        }

        .payment-method label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            width: 100%;
        }

        .payment-method i {
            font-size: 24px;
            color: #ff4757;
        }

        .payment-method span {
            font-size: 16px;
            color: #333;
        }

        .payment-form {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #666;
            font-size: 14px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #eee;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            border-color: #ff4757;
            box-shadow: 0 0 0 3px rgba(255, 71, 87, 0.1);
            outline: none;
        }

        .form-row {
            display: flex;
            gap: 15px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .upi-apps {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .upi-app {
            background: #fff;
            border: 2px solid #eee;
            border-radius: 8px;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upi-app:hover {
            border-color: #ff4757;
            transform: translateY(-2px);
        }

        .upi-app img {
            width: 30px;
            height: 30px;
            border-radius: 6px;
        }

        .upi-app span {
            font-size: 14px;
            color: #333;
        }

        .modal-footer {
            padding: 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .cancel-btn {
            background: #f8f9fa;
            border: 2px solid #eee;
            color: #666;
        }

        .cancel-btn:hover {
            background: #eee;
        }

        .checkout-btn {
            background: #ff4757;
            border: none;
            color: #fff;
        }

        .checkout-btn:hover {
            background: #ff6b81;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.3);
        }

        .payment-success {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .success-content {
            background: #fff;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            animation: scaleIn 0.5s ease-out;
        }

        .success-icon {
            font-size: 60px;
            color: #4CAF50;
            margin-bottom: 20px;
        }

        .success-content h2 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 24px;
        }

        .success-content p {
            margin: 0 0 20px 0;
            color: #666;
        }

        .success-details {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .success-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .success-detail:last-child {
            margin-bottom: 0;
        }

        .success-detail span:first-child {
            color: #666;
        }

        .success-detail span:last-child {
            color: #333;
            font-weight: 600;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.9);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #ff4757;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loading-overlay p {
            font-size: 18px;
            color: #333;
            font-weight: 500;
        }

        .payment-success-animation {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.98);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease-out;
        }

        .success-checkmark {
            width: 120px;
            height: 120px;
            background: #4CAF50;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            animation: scaleIn 0.5s ease-out;
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3);
        }

        .check-icon {
            width: 60px;
            height: 30px;
            border-left: 6px solid white;
            border-bottom: 6px solid white;
            transform: rotate(-45deg);
            margin-top: -15px;
            animation: drawCheck 0.8s ease-out forwards;
        }

        .success-content {
            text-align: center;
            margin-top: 40px;
            animation: slideUp 0.5s ease-out;
            max-width: 400px;
            padding: 0 20px;
        }

        .success-content h2 {
            font-size: 32px;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .success-content p {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .success-details {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 25px;
            margin: 30px 0;
            animation: slideUp 0.5s ease-out 0.3s forwards;
            opacity: 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .success-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .success-detail:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .success-detail span:first-child {
            color: #666;
            font-weight: 500;
            font-size: 16px;
        }

        .success-detail span:last-child {
            color: #333;
            font-weight: 600;
            font-size: 16px;
        }

        .success-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
        }

        .success-btn {
            padding: 15px 30px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 180px;
        }

        .view-order-btn {
            background: #ff4757;
            color: white;
            border: none;
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.2);
        }

        .view-order-btn:hover {
            background: #ff6b81;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 71, 87, 0.3);
        }

        .close-success-btn {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #eee;
        }

        .close-success-btn:hover {
            background: #eee;
            transform: translateY(-2px);
        }

        @keyframes drawCheck {
            0% {
                width: 0;
                height: 0;
                opacity: 0;
            }
            50% {
                width: 0;
                height: 0;
                opacity: 0;
            }
            100% {
                width: 60px;
                height: 30px;
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes slideUp {
            0% {
                transform: translateY(30px);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0;
            }
        }

        .success-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        .success-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .view-order-btn {
            background: #ff4757;
            color: white;
            border: none;
        }

        .view-order-btn:hover {
            background: #ff6b81;
            transform: translateY(-2px);
        }

        .close-success-btn {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #eee;
        }

        .close-success-btn:hover {
            background: #eee;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes drawCheck {
            0% {
                width: 0;
                height: 0;
                opacity: 0;
            }
            100% {
                width: 50px;
                height: 25px;
                opacity: 1;
            }
        }

        @keyframes scaleIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes slideUp {
            0% {
                transform: translateY(20px);
                opacity: 0;
            }
            100% {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            0% {
                opacity: 0;
            }
            100% {
                opacity: 1;
            }
        }

        .profile-section {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }

        .profile-section.active {
            right: 0;
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .profile-header h2 {
            margin: 0;
            font-size: 24px;
            color: #333;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .profile-content {
            padding: 20px;
        }

        .profile-info {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: #f8f9fa;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
        }

        .profile-avatar i {
            font-size: 40px;
            color: #666;
        }

        .profile-details h3 {
            margin: 0;
            font-size: 20px;
            color: #333;
        }

        .profile-details p {
            margin: 5px 0 0;
            color: #666;
        }

        .profile-form {
            margin-bottom: 30px;
        }

        .profile-form h4 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #666;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn-update {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .btn-update:hover {
            background: #ff6b81;
        }

        .profile-orders h4 {
            margin-bottom: 20px;
            color: #333;
        }

        .orders-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .order-item {
            padding: 15px;
            border: 1px solid #eee;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .order-item h5 {
            margin: 0 0 10px;
            color: #333;
        }

        .order-item p {
            margin: 5px 0;
            color: #666;
        }
      
   

    .pay-btn {
      padding: 15px 30px;
      font-size: 22px;
      background-color: #1abc9c;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.3s ease;
    }

    .pay-btn:hover {
      transform: scale(1.05);
      background-color: #16a085;
    }

    .success-overlay {
      position: fixed;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      background: radial-gradient(#e0ffe0, #c7f5c7);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.4s ease-out;
    }

    .checkmark {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background-color: #2ecc71;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 60px;
      color: white;
      animation: bounceIn 0.6s ease forwards;
    }

    .message {
      margin-top: 20px;
      font-size: 28px;
      font-weight: bold;
      color: #2c3e50;
      animation: slideUp 0.5s ease forwards;
    }

    .coin {
      position: fixed;
      font-size: 24px;
      color: gold;
      pointer-events: none;
      z-index: 1001;
      animation: fall linear infinite;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); }
    }

    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    @keyframes fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Profile Dropdown Styles */
    .profile-icon-container {
        position: relative;
    }

    .profile-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        width: 250px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        display: none;
        z-index: 1000;
        margin-top: 10px;
        animation: slideDown 0.3s ease-out;
    }

    .profile-dropdown.active {
        display: block;
    }

    .profile-header {
        padding: 15px;
        border-bottom: 1px solid #eee;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .profile-avatar {
        width: 40px;
        height: 40px;
        background: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
    }

    .profile-info {
        display: flex;
        flex-direction: column;
    }

    .profile-name {
        font-weight: 600;
        color: var(--text-color);
    }

    .profile-email {
        font-size: 12px;
        color: #666;
    }

    .profile-menu {
        padding: 10px 0;
    }

    .profile-menu-item {
        display: flex;
        align-items: center;
        padding: 12px 15px;
        color: var(--text-color);
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .profile-menu-item:hover {
        background: #f5f5f5;
    }

    .profile-menu-item i {
        margin-right: 10px;
        color: var(--primary-color);
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    </style>
</head>
<body>
    <div class="cart-wishlist-container">
        <button class="cart-wishlist-btn" onclick="togglePanel('cart')">
            <i class="material-icons">shopping_cart</i>
            <span class="cart-wishlist-badge" id="cart-count">0</span>
        </button>
        <button class="cart-wishlist-btn" onclick="togglePanel('wishlist')">
            <i class="material-icons">favorite</i>
            <span class="cart-wishlist-badge" id="wishlist-count">0</span>
        </button>
    </div>

    <div class="cart-wishlist-panel" id="cart-panel">
        <div class="cart-wishlist-header">
            <h2 class="cart-wishlist-title">Your Cart</h2>
            <button class="close-panel" onclick="togglePanel('cart')">✕</button>
        </div>
        <div class="cart-wishlist-items" id="cart-items"></div>
        <div class="cart-summary">
            <div class="summary-row">
                <span>Subtotal</span>
                <span id="cart-subtotal">$0.00</span>
            </div>
            <div class="summary-row">
                <span>Delivery Fee</span>
                <span id="delivery-fee">$2.99</span>
            </div>
            <div class="summary-row total">
                <span>Total</span>
                <span id="cart-total">$0.00</span>
            </div>
            <div class="order-options">
                <div class="order-option" onclick="selectOrderOption('delivery')">
                    <input type="radio" name="order-type" id="delivery" checked>
                    <label for="delivery"></label>
                    <i></i>
                </div>
                <div class="order-option" onclick="selectOrderOption('pickup')">
                    <input type="radio" name="order-type" id="pickup">
                    <label for="pickup"></label>
                    <i></i>
                </div>
                <div class="order-option" onclick="selectOrderOption('dine-in')">
                    <input type="radio" name="order-type" id="dine-in">
                    <label for="dine-in"></label>
                    <i></i>
                </div>
            </div>
            <button class="checkout-btn" onclick="proceedToCheckout()">
                <span>
                    <i class="material-icons">shopping_cart</i>
                    Complete Your Order
                </span>
            </button>
        </div>
    </div>

    <!-- Wishlist Panel -->
    <div class="wishlist-panel" id="wishlist-panel">
        <div class="wishlist-header">
            <div class="wishlist-title">
                <i class="material-icons">favorite</i>
                My Wishlist
        </div>
            <div class="wishlist-count" id="wishlist-total-count">0 items</div>
        </div>
        <div class="wishlist-items" id="wishlist-items">
            <!-- Wishlist items will be dynamically added here -->
        </div>
        <div class="wishlist-empty" id="wishlist-empty" style="display: none;">
            <i class="material-icons">favorite_border</i>
            <p>Your wishlist is empty</p>
            <p>Start adding your favorite items!</p>
            <button onclick="closeWishlist()">Continue Browsing</button>
        </div>
    </div>

    <div class="sidebar-container">
        <div class="sidebar-menu">
            <div class="sidebar-menu-top">
                <div class="sidebar-menu-item active">
                <i class="material-icons">home</i>
                <span>Home</span>
                </div>
                <div class="sidebar-menu-item">
                <i class="material-icons">restaurant</i>
                <span>Restaurants</span>
                </div>
                <div class="sidebar-menu-item">
                    <i class="material-icons">favorite</i>
                    <span>Favorites</span>
                </div>
                <div class="sidebar-menu-item settings">
                <i class="material-icons">settings</i>
                <span>Settings</span>
                </div>
                <div class="sidebar-menu-item bills" onclick="toggleBillsSection()">
                    <i class="material-icons">receipt</i>
                    <span>My Bills</span>
                </div>
            </div>
            <div class="sidebar-menu-bottom">
                <div class="sidebar-menu-item logout">
                <i class="material-icons">logout</i>
                <span onclick="logout()">Logout</span>
                </div>
            </div>
        </div>
    </div>

    <button class="sidebar-toggle" onclick="toggleSidebar()">
        <i class="material-icons">menu</i>
    </button>

    <nav>
        <div class="nav-container">
            <div class="nav-left">
                <a href="#" class="logo">HST FoodExpress</a>
                <div class="location-display" onclick="requestLocation()">
                    <i class="material-icons">location_on</i>
                    <span id="location-name">Set Location</span>
                </div>
                <ul class="nav-links">
                    <li><a href="#" onclick="showSection('home')" class="active">Home</a></li>
                    <li><a href="#" onclick="showSection('restaurants')">Restaurants</a></li>
                    <li><a href="#" onclick="showSection('about')">About</a></li>
                    <li><a href="#" onclick="showSection('contact')">Contact</a></li>
                </ul>
            </div>
            <div class="nav-right">
                <div class="nav-search">
                    <input type="text" placeholder="Search food..." oninput="searchFood(event, 'nav')">
                    <button><i class="material-icons">search</i></button>
                    <div class="search-results"></div>
                </div>
                <div class="nav-icon" onclick="togglePanel('cart')">
                    <i class="material-icons">shopping_cart</i>
                    <span class="nav-icon-badge" id="nav-cart-count">0</span>
                </div>
                <div class="nav-icon" onclick="togglePanel('wishlist')">
                    <i class="material-icons">favorite</i>
                    <span class="nav-icon-badge" id="nav-wishlist-count">0</span>
                </div>
                <div class="profile-icon-container">
                    <div class="profile-icon" onclick="toggleProfileDropdown()">
                        <i class="material-icons">person</i>
                    </div>
                    <div class="profile-dropdown">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <i class="material-icons">account_circle</i>
                            </div>
                            <div class="profile-info">
                                <span class="profile-name">User Name</span>
                                <span class="profile-email">user@example.com</span>
                            </div>
                        </div>
                        <div class="profile-menu">
                            <a href="#" class="profile-menu-item">
                                <i class="material-icons">person</i>
                                <span>My Profile</span>
                            </a>
                            <a href="#" class="profile-menu-item">
                                <i class="material-icons">settings</i>
                                <span>Settings</span>
                            </a>
                            <a href="#" class="profile-menu-item">
                                <i class="material-icons">receipt</i>
                                <span>My Orders</span>
                            </a>
                            <a href="#" class="profile-menu-item" onclick="logout()">
                                <i class="material-icons">logout</i>
                                <span>Logout</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-content-wrapper">
        <!-- Top Image Section -->
        <div class="top-image">
            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" alt="Delicious Food">
            <div class="top-image-overlay">
                <h1 class="top-image-title">Discover Delicious Food</h1>
                <p class="top-image-subtitle">Explore our curated selection of the finest restaurants and mouthwatering dishes from around the world.</p>
                <a href="#restaurants" class="top-image-btn">Explore Restaurants</a>
            </div>
        </div>

        <main>
            <section id="home" class="section active">
               
                
                <div class="home-content">
                    <div class="recommendations-section">
                        <div class="recommendations-header">
                            <h2 class="recommendations-title">AI Recommended</h2>
                            <div class="recommendations-scroll">
                                <button class="scroll-btn" onclick="scrollRecommendations('left')">
                                    <i class="material-icons">chevron_left</i>
                                </button>
                                <button class="scroll-btn" onclick="scrollRecommendations('right')">
                                    <i class="material-icons">chevron_right</i>
                                </button>
                            </div>
                        </div>
                        <div class="recommendations-grid" id="recommendations-grid">
                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Spicy Chicken Burger">
                                    <div class="food-item-badge">Burger House</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Spicy Chicken Burger', 12.99, 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'fast-food')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Spicy Chicken Burger</h3>
                                        <span class="food-item-price">$12.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.5</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>15-20 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Spicy Chicken Burger', 12.99, 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Margherita Pizza">
                                    <div class="food-item-badge">Pizza Paradise</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Margherita Pizza', 14.99, 'https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'pizza')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Margherita Pizza</h3>
                                        <span class="food-item-price">$14.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.8</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>20-25 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Margherita Pizza', 14.99, 'https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1579871494447-9811cf80d66c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Sushi Roll Platter">
                                    <div class="food-item-badge">Sushi Master</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Sushi Roll Platter', 24.99, 'https://images.unsplash.com/photo-1579871494447-9811cf80d66c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'japanese')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Sushi Roll Platter</h3>
                                        <span class="food-item-price">$24.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.7</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>25-30 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Sushi Roll Platter', 24.99, 'https://images.unsplash.com/photo-1579871494447-9811cf80d66c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1563379091339-03b21ab4a4f8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Chicken Biryani">
                                    <div class="food-item-badge">Spice Garden</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Chicken Biryani', 18.99, 'https://images.unsplash.com/photo-1563379091339-03b21ab4a4f8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'indian')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Chicken Biryani</h3>
                                        <span class="food-item-price">$18.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.9</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>30-35 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Chicken Biryani', 18.99, 'https://images.unsplash.com/photo-1563379091339-03b21ab4a4f8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1565299585323-38d6b0865b47?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Beef Tacos">
                                    <div class="food-item-badge">Taco Fiesta</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Beef Tacos', 9.99, 'https://images.unsplash.com/photo-1565299585323-38d6b0865b47?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'mexican')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Beef Tacos</h3>
                                        <span class="food-item-price">$9.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.6</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>15-20 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Beef Tacos', 9.99, 'https://images.unsplash.com/photo-1565299585323-38d6b0865b47?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1512621776951-a57141f2eefd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Vegan Buddha Bowl">
                                    <div class="food-item-badge">Green Kitchen</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Vegan Buddha Bowl', 13.99, 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'vegan')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Vegan Buddha Bowl</h3>
                                        <span class="food-item-price">$13.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.7</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>20-25 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Vegan Buddha Bowl', 13.99, 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Chocolate Cake">
                                    <div class="food-item-badge">Sweet Treats</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Chocolate Cake', 8.99, 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'desserts')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Chocolate Cake</h3>
                                        <span class="food-item-price">$8.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.8</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>10-15 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Chocolate Cake', 8.99, 'https://images.unsplash.com/photo-1578985545062-69928b1d9587?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="food-item-card">
                                <div class="food-item-image">
                                    <img src="https://images.unsplash.com/photo-1559314809-0d155014e29e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Pad Thai">
                                    <div class="food-item-badge">Asian Fusion</div>
                                    <button class="wishlist-btn" onclick="addToWishlist('Pad Thai', 15.99, 'https://images.unsplash.com/photo-1559314809-0d155014e29e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80', 'asian')">
                                        <i class="material-icons">favorite_border</i>
                                    </button>
                                </div>
                                <div class="food-item-info">
                                    <div class="food-item-header">
                                        <h3 class="food-item-title">Pad Thai</h3>
                                        <span class="food-item-price">$15.99</span>
                                    </div>
                                    <div class="food-item-meta">
                                        <div class="food-item-rating">
                                            <div class="food-item-stars">★★★★★</div>
                                            <span>4.6</span>
                                        </div>
                                        <div class="food-item-time">
                                            <i class="material-icons">schedule</i>
                                            <span>25-30 min</span>
                                        </div>
                                    </div>
                                    <div class="food-item-actions">
                                        <button class="add-to-cart" onclick="addToCart('Pad Thai', 15.99, 'https://images.unsplash.com/photo-1559314809-0d155014e29e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80')">
                                            <i class="material-icons">shopping_cart</i>
                                            Add to Cart
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="main-content">
                        <div class="pre-row-cards">
                            <div class="pre-row-card" onclick="sortItems('rating')">
                                <i class="material-icons">star</i>
                                <span>Top Rated</span>
                            </div>
                            <div class="pre-row-card" onclick="sortItems('price-low')">
                                <i class="material-icons">arrow_upward</i>
                                <span>Price: Low to High</span>
                            </div>
                            <div class="pre-row-card" onclick="sortItems('price-high')">
                                <i class="material-icons">arrow_downward</i>
                                <span>Price: High to Low</span>
                            </div>
                            <div class="pre-row-card" onclick="sortItems('delivery')">
                                <i class="material-icons">delivery_dining</i>
                                <span>Fastest Delivery</span>
                            </div>
                            <div class="pre-row-card" onclick="sortItems('popularity')">
                                <i class="material-icons">trending_up</i>
                                <span>Most Popular</span>
                            </div>
                        </div>

                        <div class="filters-section">
                            <div class="filter-categories">
                                <div class="filter-option" onclick="filterFood('all')" data-category="all">
                                    <i class="material-icons">grid_view</i>
                                    <span>All</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('burgers')" data-category="burgers">
                                    <i class="material-icons">lunch_dining</i>
                                    <span>Burgers</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('pizza')" data-category="pizza">
                                    <i class="material-icons">local_pizza</i>
                                    <span>Pizza</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('pasta')" data-category="pasta">
                                    <i class="material-icons">restaurant</i>
                                    <span>Pasta</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('salads')" data-category="salads">
                                    <i class="material-icons">eco</i>
                                    <span>Salads</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('desserts')" data-category="desserts">
                                    <i class="material-icons">cake</i>
                                    <span>Desserts</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('drinks')" data-category="drinks">
                                    <i class="material-icons">local_bar</i>
                                    <span>Drinks</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('vegan')" data-category="vegan">
                                    <i class="material-icons">spa</i>
                                    <span>Vegan</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('breakfast')" data-category="breakfast">
                                    <i class="material-icons">free_breakfast</i>
                                    <span>Breakfast</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('seafood')" data-category="seafood">
                                    <i class="material-icons">set_meal</i>
                                    <span>Seafood</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('asian')" data-category="asian">
                                    <i class="material-icons">ramen_dining</i>
                                    <span>Asian</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('biryani')" data-category="biryani">
                                    <i class="material-icons">rice_bowl</i>
                                    <span>Biryani</span>
                                </div>
                                <div class="filter-option" onclick="filterFood('mexican')" data-category="mexican">
                                    <i class="material-icons">fastfood</i>
                                    <span>Mexican</span>
                                </div>
                            </div>
                        </div>

                        <div class="food-items-grid" id="food-items-grid"></div>
                    </div>
                </div>
            </section>

            <!-- Restaurant Section -->
            <section id="restaurants" class="section">
                <div class="restaurant-section">
                    <div class="restaurant-search-container">
                        <div class="search-bar">
                            <i class="material-icons">search</i>
                            <input type="text" id="restaurant-search" placeholder="Search restaurants by name, cuisine, or location..." onkeyup="searchRestaurants()">
                            <button class="clear-search" onclick="clearSearch()">
                                <i class="material-icons">close</i>
                            </button>
                    </div>
                    <div class="search-filters">
                            <div class="filter-option" onclick="filterByRating()">
                                <i class="material-icons">star</i>
                                <span>Top Rated</span>
                        </div>
                            <div class="filter-option" onclick="filterByDelivery()">
                                <i class="material-icons">delivery_dining</i>
                                <span>Fast Delivery</span>
                        </div>
                            <div class="filter-option" onclick="filterByOffers()">
                                <i class="material-icons">local_offer</i>
                                <span>Offers</span>
                        </div>
                            <div class="filter-option" onclick="filterByVeg()">
                                <i class="material-icons">eco</i>
                                <span>Pure Veg</span>
                        </div>
                        </div>
                    </div>
                        <div class="restaurant-grid" id="restaurant-grid">
                            <!-- Restaurant cards will be dynamically added here -->
                    </div>
                </div>

                <!-- Menu Display Section -->
                <div class="menu-display" id="menu-display">
                    <div class="menu-header">
                        <div class="menu-header-info">
                            <h2 class="menu-title">All Menu Items</h2>
                            <p class="menu-cuisine">Browse through our delicious menu items</p>
                        </div>
                        <button class="reset-menu-btn" onclick="resetMenuDisplay()">
                            <i class="material-icons">refresh</i>
                            Show All Items
                        </button>
                    </div>
                    <div class="menu-content">
                        <div class="menu-categories">
                            <div class="menu-category active" onclick="filterMenuItems('all')">All Items</div>
                            <div class="menu-category" onclick="filterMenuItems('popular')">Popular</div>
                            <div class="menu-category" onclick="filterMenuItems('starters')">Starters</div>
                            <div class="menu-category" onclick="filterMenuItems('main')">Main Course</div>
                            <div class="menu-category" onclick="filterMenuItems('desserts')">Desserts</div>
                            <div class="menu-category" onclick="filterMenuItems('drinks')">Beverages</div>
                        </div>
                        <div class="menu-items" id="menu-items">
                            <!-- Menu items will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <section id="about" class="section">
                <div class="about-content">
                    <h2>About Foodie Haven</h2>
                    <p>Welcome to Foodie Haven, your ultimate destination for exploring the finest culinary experiences in town. Founded in 2023, our mission is to connect food lovers with exceptional restaurants that offer unforgettable dining experiences.</p>
                    <p>We carefully select each restaurant on our platform, ensuring they meet our high standards for quality, service, and ambiance. Whether you're looking for a casual brunch spot, an elegant dinner destination, or something in between, Foodie Haven has you covered.</p>
                    <p>Our team of food enthusiasts is constantly exploring new venues and updating our collection to bring you the latest and greatest in the culinary world. We believe that great food brings people together, and we're passionate about helping you discover your next favorite restaurant.</p>
                </div>
            </section>

            <section id="contact" class="section">
                <div class="contact-content">
                    <h2>Get in Touch</h2>
                    <p>Have questions, suggestions, or feedback? We'd love to hear from you!</p>
                    <div class="contact-form">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" placeholder="Your Name">
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" placeholder="Your Email">
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea id="message" placeholder="Your Message"></textarea>
                        </div>
                        <button class="btn" onclick="showToast('Message sent successfully!')">Send Message</button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer Section -->
        <footer class="footer">
            <div class="footer-container">
                <div class="footer-about">
                    <h3 class="footer-logo">FoodieHub</h3>
                    <p class="footer-description">Your ultimate destination for discovering the best restaurants and food experiences. We bring you the finest culinary delights from around the world.</p>
                    <div class="footer-social">
                        <a href="#" class="social-icon"><i class="material-icons">facebook</i></a>
                        <a href="#" class="social-icon"><i class="material-icons">twitter</i></a>
                        <a href="#" class="social-icon"><i class="material-icons">instagram</i></a>
                        <a href="#" class="social-icon"><i class="material-icons">youtube</i></a>
                    </div>
                </div>
                
                <div class="footer-links-section">
                    <h4 class="footer-title">Quick Links</h4>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="#">Home</a></li>
                        <li class="footer-link"><a href="#restaurants">Restaurants</a></li>
                        <li class="footer-link"><a href="#">About Us</a></li>
                        <li class="footer-link"><a href="#">Contact</a></li>
                        <li class="footer-link"><a href="#">Blog</a></li>
                    </ul>
                </div>
                
                <div class="footer-links-section">
                    <h4 class="footer-title">Categories</h4>
                    <ul class="footer-links">
                        <li class="footer-link"><a href="#">Italian</a></li>
                        <li class="footer-link"><a href="#">Indian</a></li>
                        <li class="footer-link"><a href="#">Chinese</a></li>
                        <li class="footer-link"><a href="#">Mexican</a></li>
                        <li class="footer-link"><a href="#">Desserts</a></li>
                    </ul>
                </div>
                
                <div class="footer-contact-section">
                    <h4 class="footer-title">Contact Us</h4>
                    <div class="footer-contact">
                        <div class="contact-item">
                            <div class="contact-icon"><i class="material-icons">location_on</i></div>
                            <span>123 Food Street, Cuisine City</span>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="material-icons">phone</i></div>
                            <span>+1 234 567 8900</span>
                        </div>
                        <div class="contact-item">
                            <div class="contact-icon"><i class="material-icons">email</i></div>
                            <span>info@foodiehub.com</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 FoodieHub. All Rights Reserved. <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a></p>
            </div>
        </footer>
    </div>

    <div id="toast" class="toast"></div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="payment-modal-content">
            <div class="modal-header">
                <h2>Complete Your Order</h2>
                <button class="close-modal" onclick="closePaymentModal()">
                    <i class="material-icons">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="order-summary">
                    <h3>Order Summary</h3>
                    <div id="payment-order-items"></div>
                    <div class="order-totals"></div>
                        </div>
                <div class="payment-options">
                    <h3>Payment Options</h3>
                    <div class="payment-method-options">
                        <div class="payment-method" onclick="showPaymentOption('card')">
                            <input type="radio" name="payment-method" id="card" value="Credit Card" checked>
                            <label for="card">
                                <i class="material-icons">credit_card</i>
                                <span>Credit/Debit Card</span>
                            </label>
                        </div>
                        <div class="payment-method" onclick="showPaymentOption('upi')">
                            <input type="radio" name="payment-method" id="upi" value="UPI">
                            <label for="upi">
                                <i class="material-icons">account_balance_wallet</i>
                                <span>UPI Payment</span>
                            </label>
                        </div>
                        <div class="payment-method" onclick="showPaymentOption('netbanking')">
                            <input type="radio" name="payment-method" id="netbanking" value="Net Banking">
                            <label for="netbanking">
                                <i class="material-icons">account_balance</i>
                                <span>Net Banking</span>
                            </label>
                        </div>
                        <div class="payment-method" onclick="showPaymentOption('cod')">
                            <input type="radio" name="payment-method" id="cod" value="Cash on Delivery">
                            <label for="cod">
                                <i class="material-icons">local_atm</i>
                                <span>Cash on Delivery</span>
                            </label>
                        </div>
                    </div>
                    <div class="payment-forms">
                        <div class="payment-form" id="card-form">
                        <div class="form-group">
                                <label>Card Number</label>
                                <input type="text" placeholder="1234 5678 9012 3456" maxlength="19">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                    <label>Expiry Date</label>
                                    <input type="text" placeholder="MM/YY" maxlength="5">
                            </div>
                            <div class="form-group">
                                    <label>CVV</label>
                                    <input type="text" placeholder="123" maxlength="3">
                            </div>
                        </div>
                        <div class="form-group">
                                <label>Card Holder Name</label>
                                <input type="text" placeholder="John Doe">
                        </div>
                    </div>
                        <div class="payment-form" id="upi-form" style="display: none;">
                        <div class="form-group">
                                <label>UPI ID</label>
                                <input type="text" placeholder="username@upi">
                        </div>
                            <div class="upi-apps">
                                <button class="upi-app">
                                    <img src="https://via.placeholder.com/40" alt="GPay">
                                    <span>Google Pay</span>
                                </button>
                                <button class="upi-app">
                                    <img src="https://via.placeholder.com/40" alt="PhonePe">
                                    <span>PhonePe</span>
                                </button>
                                <button class="upi-app">
                                    <img src="https://via.placeholder.com/40" alt="Paytm">
                                    <span>Paytm</span>
                                </button>
                        </div>
                    </div>
                        <div class="payment-form" id="netbanking-form" style="display: none;">
                        <div class="form-group">
                                <label>Select Bank</label>
                                <select>
                                    <option value="">Choose your bank</option>
                                    <option value="hdfc">HDFC Bank</option>
                                    <option value="icici">ICICI Bank</option>
                                    <option value="sbi">State Bank of India</option>
                                    <option value="axis">Axis Bank</option>
                                </select>
                        </div>
                        </div>
                        <div class="payment-form" id="cod-form" style="display: none;">
                            <div class="cod-info">
                                <i class="material-icons">info</i>
                                <p>Pay with cash when your order is delivered</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn cancel-btn" onclick="closePaymentModal()">Cancel</button>
                <button class="btn checkout-btn" onclick="handleClick()">Place Order</button>
                <script>
                     function handleClick() {
                        processPayment();   // 1st function
                        // makePayment(); 
                         setTimeout(makePayment, 1500);  // 2nd function
  }
    function makePayment() {
      const overlay = document.createElement('div');
      overlay.className = 'success-overlay';

      const check = document.createElement('div');
      check.className = 'checkmark';
      check.innerHTML = '✔';

      const msg = document.createElement('div');
      msg.className = 'message';
      msg.innerText = 'Payment Successful!';

      overlay.appendChild(check);
      overlay.appendChild(msg);
      document.body.appendChild(overlay);

      // Coin shower effect
      for (let i = 0; i < 30; i++) {
        const coin = document.createElement('div');
        coin.className = 'coin';
        coin.innerHTML = '💰';
        coin.style.left = Math.random() * 100 + 'vw';
        coin.style.animationDuration = (2 + Math.random() * 2) + 's';
        coin.style.animationDelay = Math.random() * 1 + 's';
        document.body.appendChild(coin);

        setTimeout(() => coin.remove(), 5000);
      }

      setTimeout(() => {
        overlay.remove();
      }, 3000);
    }
  </script>
            </div>
        </div>
    </div>

    <div class="loading-overlay">
        <div class="loading-spinner"></div>
        <p>Processing Payment...</p>
    </div>
    <!-- Payment Success Animation -->
    <div class="payment-success-animation" id="paymentSuccessAnimation">
        <div class="success-checkmark">
            <div class="check-icon"></div>
        </div>
    </div>

    <!-- Payment Success Modal -->
    <div class="payment-success">
        <div class="success-content">
            <div class="success-icon">
                <i class="material-icons">check_circle</i>
            </div>
            <h2>Payment Successful!</h2>
            <p>Your order has been placed successfully.</p>
            <div class="success-details">
                <div class="success-detail">
                    <span>Order ID:</span>
                    <span id="success-order-id"></span>
                </div>
                <div class="success-detail">
                    <span>Amount Paid:</span>
                    <span id="success-amount"></span>
                </div>
                <div class="success-detail">
                    <span>Payment Method:</span>
                    <span id="success-method"></span>
                </div>
            </div>
            <div class="success-actions">
                <button class="success-btn primary-btn" onclick="viewOrderDetails()">View Order</button>
                <button class="success-btn secondary-btn" onclick="closePaymentSuccess()">Done</button>
            </div>
        </div>
    </div>

    <!-- Bills Section -->
    <div class="bills-section">
        <div class="bills-header">
            <h2>My Bills</h2>
            <button class="close-bills" onclick="toggleBillsSection()">
                <i class="material-icons">close</i>
            </button>
        </div>
        <div class="bills-filters">
            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterBills('all')">
                    <i class="material-icons">receipt</i> All Orders
                </button>
                <button class="filter-btn" onclick="filterBills('today')">
                    <i class="material-icons">today</i> Today
                </button>
                <button class="filter-btn" onclick="filterBills('week')">
                    <i class="material-icons">date_range</i> This Week
                </button>
                <button class="filter-btn" onclick="filterBills('month')">
                    <i class="material-icons">calendar_month</i> This Month
                </button>
            </div>
            <button class="clear-bills" onclick="clearBillHistory()">
                <i class="material-icons">delete</i> Clear History
            </button>
        </div>
        <div class="bills-container" id="bills-container"></div>
    </div>

    <!-- Add this before the closing body tag -->
    <div class="ai-chat-container">
        <div class="chat-icon" onclick="toggleAIChat()">
            <ion-icon name="chatbubbles"></ion-icon>
            <span class="chat-badge">AI Help</span>
        </div>
        <div class="chatbase-frame">
            <div class="chat-header">
                <h3></h3>
                <button onclick="toggleAIChat()">
                    <ion-icon name="close-outline"></ion-icon>
                </button>
            </div>
            <iframe src="https://www.chatbase.co/chatbot-iframe/mzE873YZySteqw06T3HpA" frameborder="0"></iframe>
        </div>
    </div>

    <div class="profile-section" id="profileSection">
        <div class="profile-header">
            <h2>My Profile</h2>
            <button class="close-btn" onclick="closeProfileSection()">×</button>
        </div>
        <div class="profile-content">
            <div class="profile-info">
                <div class="profile-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <div class="profile-details">
                    <h3 id="profileName">Loading...</h3>
                    <p id="profileEmail">Loading...</p>
                </div>
            </div>
            <div class="profile-form">
                <h4>Update Profile</h4>
                <form id="updateProfileForm">
                    <div class="form-group">
                        <label for="updateFullName">Full Name</label>
                        <input type="text" id="updateFullName" name="fullName" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="updatePhone">Phone</label>
                        <input type="tel" id="updatePhone" name="phone" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="updateAddress">Address</label>
                        <textarea id="updateAddress" name="address" class="form-control" rows="3"></textarea>
                    </div>
                    <button type="submit" class="btn-update">Update Profile</button>
                </form>
            </div>
            <div class="profile-orders">
                <h4>Recent Orders</h4>
                <div class="orders-list" id="ordersList">
                    <!-- Orders will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sidebar Toggle Functionality
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar-container');
            const toggleBtn = document.querySelector('.sidebar-toggle i');
            
            sidebar.classList.toggle('expanded');
            
            // Update toggle button icon
            if (sidebar.classList.contains('expanded')) {
                toggleBtn.textContent = 'menu_open';
            } else {
                toggleBtn.textContent = 'menu';
            }
        }

        // Navigation Scroll Effect
        window.addEventListener('scroll', function() {
            const nav = document.querySelector('.nav-container');
            if (window.scrollY > 50) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }
        });

        // Slider Functionality
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');
        const totalSlides = slides.length;
        
        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            slides[index].classList.add('active');
            dots[index].classList.add('active');
        }
        
        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            showSlide(currentSlide);
        }
        
        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            showSlide(currentSlide);
        }
        
        // Auto slide every 5 seconds
        setInterval(nextSlide, 5000);

        // Panel Toggle with Animation
        function togglePanel(type) {
            const panel = document.getElementById(`${type}-panel`);
            const overlay = document.createElement('div');
            overlay.className = 'panel-overlay';
            
            if (!panel.classList.contains('expanded')) {
                document.body.appendChild(overlay);
                setTimeout(() => overlay.classList.add('visible'), 10);
                panel.classList.add('expanded');
                
                // Animate panel items
                const items = panel.querySelectorAll('.panel-item');
                items.forEach((item, index) => {
                    item.style.animation = `slideInRight 0.3s ease-out ${index * 0.1}s forwards`;
                });
            } else {
                const existingOverlay = document.querySelector('.panel-overlay');
                if (existingOverlay) {
                    existingOverlay.classList.remove('visible');
                    setTimeout(() => existingOverlay.remove(), 300);
                }
                panel.classList.remove('expanded');
            }
        }

        // Enhanced Toast Notification with Professional Animation
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            
            // Clear any existing content
            toast.innerHTML = '';
            
            // Create toast content with icon
            const icon = document.createElement('i');
            icon.className = 'material-icons toast-icon';
            
            if (type === 'success') {
                icon.textContent = 'check_circle';
                toast.className = 'toast toast-success';
            } else if (type === 'error') {
                icon.textContent = 'error';
                toast.className = 'toast toast-error';
            } else if (type === 'warning') {
                icon.textContent = 'warning';
                toast.className = 'toast toast-warning';
            } else if (type === 'info') {
                icon.textContent = 'info';
                toast.className = 'toast toast-info';
            }
            
            const textSpan = document.createElement('span');
            textSpan.textContent = message;
            
            // Create progress bar
            const progressBar = document.createElement('div');
            progressBar.className = 'toast-progress';
            
            // Append elements
            toast.appendChild(icon);
            toast.appendChild(textSpan);
            toast.appendChild(progressBar);
            
            // Show toast with animation
            toast.classList.add('show');
            
            // Animate progress bar
            setTimeout(() => {
                progressBar.style.width = '0%';
            }, 100);
            
            // Hide toast after delay
            setTimeout(() => {
                toast.classList.add('hide');
                setTimeout(() => {
                    toast.classList.remove('show', 'hide');
                }, 500);
            }, 3000);
        }

        // Show section
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
                if (section.id === sectionId) {
                    section.classList.add('active');
                }
            });

            // Update active state in sidebar
            document.querySelectorAll('.sidebar-menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('onclick').includes(sectionId)) {
                    item.classList.add('active');
                }
            });

            // Update active state in navigation
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial sidebar state
            const sidebar = document.querySelector('.sidebar-container');
            const toggleBtn = document.querySelector('.sidebar-toggle i');
            
            sidebar.classList.remove('expanded');
            toggleBtn.textContent = 'menu';

            // Close sidebar when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.sidebar-container') && 
                    !event.target.closest('.sidebar-toggle') && 
                    sidebar.classList.contains('expanded')) {
                    sidebar.classList.remove('expanded');
                    toggleBtn.textContent = 'menu';
                }
            });

            // Initialize other components
            displayFoodItems();
            displayRestaurants();
            displayAllMenuItems();
            initializeFilters();
            filterFood('all');
            
            // Initialize food items display on page load
            filterFood('all');
            
            // Add active class styling to filter options
            const filterOptions = document.querySelectorAll('.filter-option');
            filterOptions.forEach(option => {
                if (option.getAttribute('data-category') === 'all') {
                    option.classList.add('active');
                }
            });
            
            // Display restaurants
            displayRestaurants();
            
            // Load cart and wishlist from storage
            loadCartFromStorage();
            loadWishlistFromStorage();
            
            // Update UI
            updateCart();
            updateWishlistUI();
            updateCartBadge();
            updateWishlistBadge();
        });

        // Restaurant data
        const restaurants = [
            {
                id: 1,
                name: "Spice Garden",
                cuisine: "Indian",
                rating: 4.8,
                image: "https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80",
               
                menu: [
                    {
                        id: "sg1",
                        name: "Chicken Biryani",
                        price: 15.99,
                        category: "biryani",
                        image: "https://images.unsplash.com/photo-1563379091339-03b21ab4a4f8",
                      
                    },
                    {
                        id: "sg2",
                        name: "Butter Chicken",
                        price: 16.99,
                        category: "curry",
                        image: "https://images.unsplash.com/photo-1603894584378-8a23f039d93a",
                        
                    },
                    {
                        id: "sg3",
                        name: "Vegetable Korma",
                        price: 14.99,
                        category: "curry",
                        image: "https://images.unsplash.com/photo-1585937421612-70a008356fbe",
                     
                    },
                    {
                        id: "sg4",
                        name: "Garlic Naan",
                        price: 3.99,
                        category: "bread",
                        image: "https://images.unsplash.com/photo-1565958011703-44f9829ba187",
                        
                    },
                    {
                        id: "sg5",
                        name: "Mango Lassi",
                        price: 4.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1505252585461-04db1eb84625",
                       
                    }
                ]
            },
            {
                id: 2,
                name: "Pasta Paradise",
                cuisine: "Italian",
                rating: 4.7,
                image: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5",
               
                menu: [
                    {
                        id: "pp1",
                        name: "Spaghetti Carbonara",
                        price: 13.99,
                        category: "pasta",
                        image: "https://images.unsplash.com/photo-1612874742237-6526221588e3",
                     
                    },
                    {
                        id: "pp2",
                        name: "Margherita Pizza",
                        price: 14.99,
                        category: "pizza",
                        image: "https://images.unsplash.com/photo-1604382355076-af4b0eb60143",
                      
                    },
                    {
                        id: "pp3",
                        name: "Lasagna",
                        price: 15.99,
                        category: "pasta",
                        image: "https://images.unsplash.com/photo-1619894991066-b0849eb1f8ea",
                      
                    },
                    {
                        id: "pp4",
                        name: "Tiramisu",
                        price: 6.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1571877227200-a0d98ea607e9",
                      
                    },
                    {
                        id: "pp5",
                        name: "Italian Wine",
                        price: 8.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1510812431401-41d2bd2722f3",
                      
                    }
                ]
            },
            {
                id: 3,
                name: "Burger House",
                cuisine: "American",
                rating: 4.6,
                image: "https://images.unsplash.com/photo-1571091718767-18b5b0865b47",
                description: "Gourmet burgers and American classics",
                menu: [
                    {
                        id: "bh1",
                        name: "Classic Cheeseburger",
                        price: 12.99,
                        category: "burgers",
                        image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd",
                      
                    },
                    {
                        id: "bh2",
                        name: "BBQ Bacon Burger",
                        price: 14.99,
                        category: "burgers",
                        image: "https://images.unsplash.com/photo-1594212699903-ec8a3eca50f5",
                        description: "Beef patty with bacon and BBQ sauce"
                    },
                    {
                        id: "bh3",
                        name: "Chicken Wings",
                        price: 11.99,
                        category: "appetizers",
                        image: "https://images.unsplash.com/photo-1567620835723-2b1c7d93587e",
                       
                    },
                    {
                        id: "bh4",
                        name: "French Fries",
                        price: 4.99,
                        category: "sides",
                        image: "https://images.unsplash.com/photo-1573080496219-bb080dd4f877",
                        description: "Crispy golden fries with seasoning"
                    },
                    {
                        id: "bh5",
                        name: "Milkshake",
                        price: 5.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1572490122747-3968b75cc699",
                       
                    }
                ]
            },
            {
                id: 4,
                name: "Sushi Master",
                cuisine: "Japanese",
                rating: 4.9,
                image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
               
                menu: [
                    {
                        id: "sm1",
                        name: "California Roll",
                        price: 12.99,
                        category: "sushi",
                        image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
                      
                    },
                    {
                        id: "sm2",
                        name: "Salmon Nigiri",
                        price: 14.99,
                        category: "sushi",
                        image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
                       
                    },
                    {
                        id: "sm3",
                        name: "Miso Soup",
                        price: 5.99,
                        category: "soups",
                        image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
                    
                    },
                    {
                        id: "sm4",
                        name: "Tempura Udon",
                        price: 13.99,
                        category: "noodles",
                        image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
                       
                    },
                    {
                        id: "sm5",
                        name: "Green Tea",
                        price: 3.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c",
                       
                    }
                ]
            },
            {
                id: 5,
                name: "Taco Fiesta",
                cuisine: "Mexican",
                rating: 4.5,
                image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
            
                menu: [
                    {
                        id: "tf1",
                        name: "Beef Tacos",
                        price: 9.99,
                        category: "tacos",
                        image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                      
                    },
                    {
                        id: "tf2",
                        name: "Chicken Burrito",
                        price: 11.99,
                        category: "burritos",
                        image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                       
                    },
                    {
                        id: "tf3",
                        name: "Guacamole & Chips",
                        price: 7.99,
                        category: "appetizers",
                        image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                       
                    },
                    {
                        id: "tf4",
                        name: "Churros",
                        price: 5.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                      
                    },
                    {
                        id: "tf5",
                        name: "Horchata",
                        price: 4.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                    
                    }
                ]
            },
            {
                id: 6,
                name: "Green Kitchen",
                cuisine: "Vegan",
                rating: 4.7,
                image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd",
              
                menu: [
                    {
                        id: "gk1",
                        name: "Buddha Bowl",
                        price: 13.99,
                        category: "vegan",
                        image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd",
                      
                    },
                    {
                        id: "gk2",
                        name: "Vegan Burger",
                        price: 12.99,
                        category: "burgers",
                        image: "https://images.unsplash.com/photo-1525059696034-4967a8e1dca2",
                       
                    },
                    {
                        id: "gk3",
                        name: "Kale Salad",
                        price: 10.99,
                        category: "salads",
                        image: "https://images.unsplash.com/photo-1540189549336-e6e99c3679fe",
                      
                    },
                    {
                        id: "gk4",
                        name: "Vegan Pizza",
                        price: 14.99,
                        category: "pizza",
                        image: "https://images.unsplash.com/photo-1604382355076-af4b0eb60143",
                     
                    },
                    {
                        id: "gk5",
                        name: "Smoothie Bowl",
                        price: 9.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1505252585461-04db1eb84625",
                       
                    }
                ]
            },
            {
                id: 7,
                name: "Sweet Treats",
                cuisine: "Desserts",
                rating: 4.8,
                image: "https://images.unsplash.com/photo-1578985545062-69928b1d9587",
             
                menu: [
                    {
                        id: "st1",
                        name: "Chocolate Cake",
                        price: 8.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1578985545062-69928b1d9587",
                       
                    },
                    {
                        id: "st2",
                        name: "Cheesecake",
                        price: 7.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1524351199678-941a58a3df50",
                       
                    },
                    {
                        id: "st3",
                        name: "Ice Cream Sundae",
                        price: 6.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1563805042-7684c019e1cb",
                       
                    },
                    {
                        id: "st4",
                        name: "Apple Pie",
                        price: 5.99,
                        category: "desserts",
                        image: "https://images.unsplash.com/photo-1621743478914-4b5d3e0e0906",
                       
                    },
                    {
                        id: "st5",
                        name: "Hot Chocolate",
                        price: 4.99,
                        category: "drinks",
                        image: "https://images.unsplash.com/photo-1572490122747-3968b75cc699",
                      
                    }
                ]
            }
        ];

        // Display restaurants
        function displayRestaurants(filter = 'all') {
            const restaurantGrid = document.getElementById('restaurant-grid');
            restaurantGrid.innerHTML = '';
            
            // Create a copy of the restaurants array to sort
            let displayedRestaurants = [...restaurants];
            
            // Apply filters
            if (filter === 'rating') {
                displayedRestaurants = displayedRestaurants.filter(r => r.rating >= 4.5);
            } else if (filter === 'delivery') {
                displayedRestaurants = displayedRestaurants.filter(r => r.deliveryTime && r.deliveryTime <= 30);
            } else if (filter === 'offers') {
                displayedRestaurants = displayedRestaurants.filter(r => r.hasOffer);
            } else if (filter === 'veg') {
                displayedRestaurants = displayedRestaurants.filter(r => r.isVegetarian);
            }
            
            // Sort by rating by default
            sortRestaurants('rating', displayedRestaurants);
        }

        // Function to sort restaurants
        function sortRestaurants(criteria, restaurantList = null) {
            const restaurantGrid = document.getElementById('restaurant-grid');
            
            // If no list is provided, get all restaurants from the grid
            if (!restaurantList) {
                restaurantList = [...restaurants];
            }
            
            // Sort based on criteria
            if (criteria === 'rating') {
                restaurantList.sort((a, b) => b.rating - a.rating);
            } else if (criteria === 'name') {
                restaurantList.sort((a, b) => a.name.localeCompare(b.name));
            } else if (criteria === 'popularity') {
                restaurantList.sort((a, b) => (b.popularity || 0) - (a.popularity || 0));
            }
            
            // Clear the grid
            restaurantGrid.innerHTML = '';
            
            // Display the sorted restaurants
            restaurantList.forEach((restaurant, index) => {
                const card = document.createElement('div');
                card.className = 'restaurant-card';
                card.style.animationDelay = `${index * 0.1}s`;
                card.onclick = () => displayRestaurantMenu(restaurant);
                
                // Calculate delivery time or use default
                const deliveryTime = restaurant.deliveryTime || '30-45';
                
                // Check if restaurant has offers
                const hasOffer = restaurant.hasOffer ? 
                    `<div class="restaurant-offer-badge">
                        <i class="fas fa-percent"></i> ${restaurant.offerText || 'Special Offer'}
                    </div>` : '';
                
                // Generate popular dishes list
                const popularDishes = restaurant.menu && restaurant.menu.length > 0 ? 
                    restaurant.menu.slice(0, 3).map(item => item.name).join(', ') : 
                    'Menu items not available';
                
                // Calculate open status
                const currentHour = new Date().getHours();
                const isOpen = (currentHour >= 10 && currentHour < 22);
                const openStatus = isOpen ? 
                    `<span class="open-now"><i class="fas fa-circle"></i> Open Now</span>` : 
                    `<span class="closed"><i class="fas fa-circle"></i> Closed</span>`;
                
                card.innerHTML = `
                    <div class="restaurant-image" style="background-image: url('${restaurant.image}')">
                        ${hasOffer}
                        <div class="restaurant-quick-view">
                            <button class="quick-view-btn">Quick View</button>
                        </div>
                    </div>
                    <div class="restaurant-info">
                        <div class="restaurant-header">
                            <h3 class="restaurant-title">${restaurant.name}</h3>
                            <div class="restaurant-rating">
                                <div class="stars">
                                    ${'★'.repeat(Math.floor(restaurant.rating))}${'☆'.repeat(5 - Math.floor(restaurant.rating))}
                                </div>
                                <span>${restaurant.rating}</span>
                            </div>
                        </div>
                        <div class="restaurant-status">
                            ${openStatus}
                            <span class="restaurant-reviews">${restaurant.reviewCount || '120'} reviews</span>
                        </div>
                       
                        <div class="restaurant-meta">
                            <div class="restaurant-delivery">
                                <i class="fas fa-clock"></i>
                                <span>${deliveryTime} min</span>
                            </div>
                            <div class="restaurant-price">
                                <i class="fas fa-dollar-sign"></i>
                                <span>${restaurant.priceRange || '$$'}</span>
                            </div>
                            ${restaurant.isVegetarian ? 
                                `<div class="restaurant-veg">
                                    <i class="fas fa-leaf"></i>
                                    <span>Pure Veg</span>
                                </div>` : ''}
                        </div>
                        <div class="restaurant-popular">
                            <h4>Popular Dishes:</h4>
                            <p>${popularDishes}</p>
                        </div>
                        <div class="restaurant-footer">
                            <div class="restaurant-distance">
                                <i class="fas fa-map-marker-alt"></i>
                                <span>${restaurant.distance || '2.5 km'}</span>
                            </div>
                            <button class="view-menu-btn">View Menu</button>
                        </div>
                    </div>
                `;
                
                restaurantGrid.appendChild(card);
            });
            
            // Update filter buttons to show active state
            const filterButtons = document.querySelectorAll('.search-filter');
            filterButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.trim() === 'All Restaurants' && criteria === 'all') {
                    btn.classList.add('active');
                } else if (btn.textContent.trim() === 'Top Rated' && criteria === 'rating') {
                    btn.classList.add('active');
                }
            });
        }

        // Helper function to generate star ratings
        function generateStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= rating) {
                    stars += '<i class="fas fa-star"></i>';
                } else if (i - 0.5 <= rating) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            return stars;
        }

        // Display restaurant menu
        function displayRestaurantMenu(restaurant) {
            const menuItems = document.getElementById('menu-items');
            const menuTitle = document.querySelector('.menu-title');
            const menuCuisine = document.querySelector('.menu-cuisine');
            const menuDisplay = document.getElementById('menu-display');

            // Update menu header with restaurant info
            menuTitle.textContent = restaurant.name;
            menuCuisine.textContent = restaurant.cuisine;

            // Show menu display section
            menuDisplay.classList.add('active');

            // Clear existing menu items
            menuItems.innerHTML = '';

            // Add menu items from the selected restaurant
            restaurant.menu.forEach((item, index) => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item-card';
                menuItem.style.animationDelay = `${index * 0.1}s`;
                menuItem.innerHTML = `
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="restaurant-badge">${restaurant.name}</div>
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                    </div>
                    <div class="menu-item-info">
                        <div class="menu-item-header">
                            <h3 class="menu-item-title">${item.name}</h3>
                            <span class="menu-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="menu-item-meta">
                            <div class="menu-item-rating">
                                <span class="stars">${'★'.repeat(Math.floor(restaurant.rating))}${'☆'.repeat(5 - Math.floor(restaurant.rating))}</span>
                                <span>${restaurant.rating}</span>
                            </div>
                            <div class="menu-item-time">
                                <i class="material-icons">access_time</i>
                                <span>30-40 min</span>
                            </div>
                        </div>
                        <div class="menu-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;
                menuItems.appendChild(menuItem);
            });

            // Update menu categories to show active state
            const menuCategories = document.querySelectorAll('.menu-category');
            menuCategories.forEach(category => {
                category.classList.remove('active');
                if (category.textContent.toLowerCase() === 'all items') {
                    category.classList.add('active');
                }
            });

            // Scroll to menu display
            menuDisplay.scrollIntoView({ behavior: 'smooth' });
        }

        // Function to reset menu display to show all items
        function resetMenuDisplay() {
            const menuTitle = document.querySelector('.menu-title');
            const menuCuisine = document.querySelector('.menu-cuisine');
            const menuDisplay = document.getElementById('menu-display');

            // Reset header
            menuTitle.textContent = 'All Menu Items';
            menuCuisine.textContent = 'Browse through our delicious menu items';

            // Hide menu display section
            menuDisplay.classList.remove('active');

            // Display all menu items
            displayAllMenuItems();
        }

        // Function to display all menu items initially
        function displayAllMenuItems() {
            const menuItems = document.getElementById('menu-items');
            if (!menuItems) return;

            const allMenuItems = restaurants.flatMap(restaurant => 
                restaurant.menu.map(item => ({
                    ...item,
                    restaurantName: restaurant.name,
                    restaurantRating: restaurant.rating
                }))
            );

            menuItems.innerHTML = allMenuItems.map((item, index) => `
                <div class="menu-item-card" style="animation-delay: ${index * 0.1}s">
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                        <span class="restaurant-badge">${item.restaurantName}</span>
                    </div>
                    <div class="menu-item-info">
                        <div class="menu-item-header">
                            <h3 class="menu-item-title">${item.name}</h3>
                            <span class="menu-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="menu-item-meta">
                            <div class="menu-item-rating">
                                <span class="stars">${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}</span>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="menu-item-time">
                                <i class="material-icons">access_time</i>
                                <span>30-40 min</span>
                            </div>
                        </div>
                        <div class="menu-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Add debounce function to optimize search performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Apply debounce to search inputs
        document.querySelectorAll('.search-input, .nav-search input').forEach(input => {
            input.addEventListener('input', debounce(function(e) {
                searchFood(e, e.target.closest('.nav-search') ? 'nav' : 'hero');
            }, 300));
        });

        // Add these variables
        let cart = [];
        let wishlistItems = [];
        let selectedOrderType = 'delivery';
        let deliveryFee = 2.99;

        // Store wishlist items in localStorage
        function saveWishlistToStorage() {
            localStorage.setItem('wishlistItems', JSON.stringify(wishlistItems));
        }

        function loadWishlistFromStorage() {
            const stored = localStorage.getItem('wishlistItems');
            if (stored) {
                wishlistItems = JSON.parse(stored);
                updateWishlistUI();
                updateWishlistBadge();
            }
        }

        // Enhanced addToWishlist function
        function addToWishlist(name, price, image, category) {
            if (!wishlistItems.some(item => item.name === name)) {
                wishlistItems.push({ 
                    name, 
                    price, 
                    image, 
                    category,
                    addedAt: new Date().toISOString()
                });
                saveWishlistToStorage();
                updateWishlistUI();
                updateWishlistBadge();
                showToast(`Added ${name} to wishlist`);
                
                // Update heart icon state - make it red
                const heartBtns = document.querySelectorAll(`[data-item-name="${name}"] .wishlist-btn`);
                heartBtns.forEach(btn => {
                    btn.classList.add('active');
                    btn.innerHTML = '<i class="material-icons" style="color: red;">favorite</i>';
                });
            } else {
                // If already in wishlist, remove it
                removeFromWishlist(name);
            }
        }
        
        // Function to move item from wishlist to cart
        function moveToCart(name) {
            // Find the item in wishlist
            const item = wishlistItems.find(item => item.name === name);
            if (!item) return;
            
            // Add to cart
            addToCart(item.name, item.price, item.image);
            
            // Show success animation
            const wishlistCard = document.querySelector(`.wishlist-card[data-item-name="${name}"]`);
            if (wishlistCard) {
                // Add animation class
                wishlistCard.classList.add('added-to-cart');
                
                // Remove from wishlist after animation
                setTimeout(() => {
                    removeFromWishlist(name);
                }, 800);
            }
            
            showToast(`${name} added to cart!`, 'success');
        }

        // Enhanced removeFromWishlist function
        function removeFromWishlist(name) {
            wishlistItems = wishlistItems.filter(item => item.name !== name);
            
            saveWishlistToStorage();
            updateWishlistUI();
            updateWishlistBadge();
            
            // Update heart icon state - make it gray
            const heartBtns = document.querySelectorAll(`[data-item-name="${name}"] .wishlist-btn`);
            heartBtns.forEach(btn => {
                btn.classList.remove('active');
                btn.innerHTML = '<i class="material-icons" style="color: #666;">favorite_border</i>';
            });
            
            showToast(`Removed ${name} from wishlist`);
        }

        // Update wishlist badge
        function updateWishlistBadge() {
            const wishlistCount = document.getElementById('wishlist-count');
            const navWishlistCount = document.getElementById('nav-wishlist-count');
            
            if (wishlistCount) {
                wishlistCount.textContent = wishlistItems.length;
            }
            
            if (navWishlistCount) {
                navWishlistCount.textContent = wishlistItems.length;
            }
        }

        // Store cart items in localStorage
        function saveCartToStorage() {
            localStorage.setItem('cartItems', JSON.stringify(cart));
        }

        function loadCartFromStorage() {
            const stored = localStorage.getItem('cartItems');
            if (stored) {
                cart = JSON.parse(stored);
                updateCart();
                updateCartBadge();
            }
        }

        // Enhanced addToCart function
        function addToCart(name, price, image) {
            // Check if item already exists in cart
            const existingItem = cart.find(item => item.name === name);
            
            if (existingItem) {
                // If item exists, increase quantity
                existingItem.quantity = (existingItem.quantity || 1) + 1;
            } else {
                // If item doesn't exist, add it to cart
                cart.push({ 
                    name, 
                    price, 
                    image,
                    quantity: 1,
                    addedAt: new Date().toISOString()
                });
            }
            
            // Save to localStorage and update UI
            saveCartToStorage();
            updateCart();
            updateCartBadge();
            
            // Show toast notification
            showToast(`Added ${name} to cart`);
        }

        // Enhanced removeFromCart function
        function removeFromCart(name) {
            // Find the item in the cart
            const itemIndex = cart.findIndex(item => item.name === name);
            
            if (itemIndex !== -1) {
                // Remove the item
                const removedItem = cart[itemIndex];
                cart.splice(itemIndex, 1);
                
                // Save to localStorage and update UI
                saveCartToStorage();
                updateCart();
                updateCartBadge();
                
                // Show toast notification
                showToast(`Removed ${removedItem.name} from cart`);
            }
        }

        // Update cart badge
        function updateCartBadge() {
            const cartCount = document.getElementById('cart-count');
            const navCartCount = document.getElementById('nav-cart-count');
            
            if (cartCount) {
                cartCount.textContent = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
            }
            
            if (navCartCount) {
                navCartCount.textContent = cart.reduce((sum, item) => sum + (item.quantity || 1), 0);
            }
        }

        // Enhanced updateCart function
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartTotal = document.getElementById('cart-total');
            
            if (!cartItems) return;
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <i class="material-icons">shopping_cart</i>
                        <p>Your cart is empty</p>
                        <button class="btn" onclick="togglePanel('cart')">Continue Shopping</button>
                    </div>
                `;
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-wishlist-item">
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-wishlist-item-info">
                        <h3 class="cart-wishlist-item-title">${item.name}</h3>
                        <p class="cart-wishlist-item-price">$${item.price.toFixed(2)}</p>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', ${(item.quantity || 1) - 1})">-</button>
                            <input type="number" class="quantity-input" value="${item.quantity || 1}" min="1" onchange="updateQuantity('${item.name}', this.value)">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', ${(item.quantity || 1) + 1})">+</button>
                        </div>
                    </div>
                    <button class="remove-item" onclick="removeFromCart('${item.name}')">✕</button>
                </div>
            `).join('');
            
            // Update cart counts
            updateCartBadge();
            
            // Calculate totals
            const subtotal = cart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
            const total = subtotal + (selectedOrderType === 'delivery' ? deliveryFee : 0);
            
            if (cartSubtotal) {
                cartSubtotal.textContent = `$${subtotal.toFixed(2)}`;
            }
            
            if (cartTotal) {
                cartTotal.textContent = `$${total.toFixed(2)}`;
            }
        }

        // Enhanced updateQuantity function
        function updateQuantity(itemName, newQuantity) {
            const item = cart.find(item => item.name === itemName);
            if (item) {
                // Ensure quantity is at least 1
                item.quantity = Math.max(1, parseInt(newQuantity));
                
                // Save to localStorage and update UI
                saveCartToStorage();
                updateCart();
            }
        }

        // Enhanced checkout function
        function checkout() {
            if (cart.length === 0) {
                showToast('Your cart is empty!');
                return;
            }
            
            // Show payment modal instead of directly processing
            showPaymentModal();
        }

        // Payment modal functions
        function showPaymentModal() {
            // Check if cart is empty
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length === 0) {
                showToast('Your cart is empty. Please add items to proceed.', 'error');
                return;
            }

            const modal = document.getElementById('paymentModal');
            const orderItems = document.getElementById('payment-order-items');
            const subtotal = document.getElementById('payment-subtotal');
            const tax = document.getElementById('payment-tax');
            const total = document.getElementById('payment-total');
            
            // Calculate totals
            const subtotalAmount = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const taxAmount = subtotalAmount * 0.05;
            const totalAmount = subtotalAmount + taxAmount + 40; // Adding delivery fee
            
            // Update order items
            orderItems.innerHTML = cart.map(item => `
                <div class="payment-item">
                    <span>${item.name} x ${item.quantity}</span>
                    <span>₹${(item.price * item.quantity).toFixed(2)}</span>
                </div>
            `).join('');
            
            // Update totals
            subtotal.textContent = `₹${subtotalAmount.toFixed(2)}`;
            tax.textContent = `₹${taxAmount.toFixed(2)}`;
            total.textContent = `₹${totalAmount.toFixed(2)}`;
            
            // Show modal
            modal.style.display = 'flex';
        }
        
        function closePaymentModal() {
            const modal = document.getElementById('paymentModal');
            modal.style.display = 'none';
        }
        
        function selectPaymentMethod(method) {
            document.querySelectorAll('.payment-form').forEach(form => form.style.display = 'none');
            document.getElementById(`${method}-payment-form`).style.display = 'block';
            document.getElementById(`${method}-payment`).checked = true;
        }
        
        function processPayment() {
            // Show loading animation
            const loadingOverlay = document.querySelector('.loading-overlay');
            loadingOverlay.style.display = 'flex';
            
            // Simulate payment processing
            setTimeout(() => {
                // Hide loading animation
                loadingOverlay.style.display = 'none';
                
                // Get payment details
                const orderId = 'ORD' + Math.floor(Math.random() * 1000000);
                const amount = calculateOrderTotal();
                const method = document.querySelector('input[name="payment-method"]:checked').value;
                
                // Show success animation
                const successAnimation = document.getElementById('paymentSuccessAnimation');
                successAnimation.style.display = 'flex';
                successAnimation.style.opacity = '1';
                
                // Update success details
                document.getElementById('success-order-id').textContent = orderId;
                document.getElementById('success-amount').textContent = `₹${amount.toFixed(2)}`;
                document.getElementById('success-method').textContent = method;
                
                // Create bill object
                const bill = {
                    id: orderId,
                    date: new Date().toISOString(),
                    items: JSON.parse(localStorage.getItem('cartItems') || '[]'),
                    subtotal: amount.subtotal,
                    deliveryFee: amount.deliveryFee,
                    tax: amount.tax,
                    total: amount.total,
                    paymentMethod: method,
                    status: 'success'
                };
                
                // Store bill
                storeBill(bill);
                
                // Clear cart
                localStorage.removeItem('cartItems');
                updateCartCount();
                
                // Close payment modal
                closePaymentModal();
                
                // Show success modal after animation
                setTimeout(() => {
                    const paymentSuccess = document.querySelector('.payment-success');
                    paymentSuccess.classList.add('active');
                    
                    // Hide animation after 2 seconds
                    setTimeout(() => {
                        successAnimation.style.opacity = '0';
                        setTimeout(() => {
                            successAnimation.style.display = 'none';
                        }, 300);
                    }, 2000);
                }, 500);
            }, 2000);
        }

        function closeSuccessAnimation() {
            const successAnimation = document.getElementById('paymentSuccessAnimation');
            successAnimation.style.animation = 'fadeOut 0.5s ease-out forwards';
            setTimeout(() => {
                successAnimation.style.display = 'none';
                successAnimation.style.animation = 'fadeIn 0.3s ease-out';
                
                // Show success toast
                showToast('Order placed successfully!', 'success');
                
                // Show bills section
                toggleBillsSection();
            }, 500);
        }

        function viewOrderDetails() {
            // Close success animation
            closeSuccessAnimation();
            
            // Show bills section
            toggleBillsSection();
        }

        function showPaymentOption(option) {
            // Hide all payment forms
            document.querySelectorAll('.payment-form').forEach(form => {
                form.style.display = 'none';
            });
            
            // Show selected payment form
            document.getElementById(option + '-form').style.display = 'block';
            
            // Update selected payment method
            document.querySelectorAll('.payment-method').forEach(method => {
                method.classList.remove('selected');
            });
            document.getElementById(option).parentElement.classList.add('selected');
            
            // Ensure the corresponding radio button is checked
            document.getElementById(option).checked = true;
            
            // Add animation class
            const form = document.getElementById(option + '-form');
            form.classList.add('animate');
            setTimeout(() => {
                form.classList.remove('animate');
            }, 500);
        }

        function showPaymentSuccess(orderId, amount, method) {
            document.getElementById('success-order-id').textContent = orderId;
            document.getElementById('success-amount').textContent = `₹${amount.toFixed(2)}`;
            document.getElementById('success-method').textContent = method;
            
            const successModal = document.querySelector('.payment-success');
            successModal.classList.add('active');
            
            // Close payment modal
            closePaymentModal();
            
            // Auto close success message after 5 seconds and show bills section
            setTimeout(() => {
                closePaymentSuccess();
                toggleBillsSection(); // Show bills section
            }, 5000);
        }

        function closePaymentSuccess() {
            const paymentSuccess = document.querySelector('.payment-success');
            paymentSuccess.classList.remove('active');
            
            // Show bills section
            toggleBillsSection();
        }

        function toggleBillsSection() {
            const billsSection = document.querySelector('.bills-section');
            billsSection.classList.toggle('active');
            
            // If opening bills section, display all bills
            if (billsSection.classList.contains('active')) {
                // Get bills from localStorage
                const bills = JSON.parse(localStorage.getItem('bills')) || [];
                
                // Display bills
                const container = document.getElementById('bills-container');
                container.innerHTML = '';
                
                if (bills.length === 0) {
                    container.innerHTML = `
                        <div class="empty-bills">
                            <i class="material-icons">receipt_long</i>
                            <p>No bills found</p>
                            <span>Your order history will appear here</span>
                        </div>
                    `;
                return;
            }
            
                // Display bills
                displayBills(bills);
                
                // Update active filter button
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.textContent.toLowerCase().includes('all')) {
                        btn.classList.add('active');
                    }
                });
            }
        }

        function filterBills(filter) {
            const bills = JSON.parse(localStorage.getItem('bills') || '[]');
            const now = new Date();
            
            let filteredBills = bills;
            if (filter !== 'all') {
                filteredBills = bills.filter(bill => {
                    const billDate = new Date(bill.date);
                    const diffTime = now - billDate;
                    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    
                    switch (filter) {
                        case 'today':
                            return diffDays === 0;
                        case 'week':
                            return diffDays <= 7;
                        case 'month':
                            return diffDays <= 30;
                        default:
                            return true;
                    }
                });
            }
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(filter)) {
                    btn.classList.add('active');
                }
            });
            
            displayBills(filteredBills);
        }

        function displayBills(bills) {
            const container = document.getElementById('bills-container');
            container.innerHTML = '';
            
            if (bills.length === 0) {
                container.innerHTML = `
                    <div class="empty-bills">
                        <i class="material-icons">receipt</i>
                        <p>No bills found</p>
                    </div>
                `;
                return;
            }
            
            bills.forEach(bill => {
                const billDate = new Date(bill.date);
                const formattedDate = billDate.toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const billHtml = `
                    <div class="bill-card">
                        <div class="bill-header">
                            <div class="bill-id">Order #${bill.id}</div>
                            <div class="bill-date">${formattedDate}</div>
                        </div>
                        <div class="bill-items">
                            ${bill.items.map(item => `
                                <div class="bill-item">
                                    <span class="bill-item-name">${item.name} x ${item.quantity}</span>
                                    <span class="bill-item-price">₹${(item.price * item.quantity).toFixed(2)}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bill-total">
                            <div class="summary-row">
                                <span>Subtotal</span>
                                <span>₹${bill.subtotal.toFixed(2)}</span>
                            </div>
                            <div class="summary-row">
                                <span>Delivery Fee</span>
                                <span>₹${bill.deliveryFee.toFixed(2)}</span>
                            </div>
                            <div class="summary-row">
                                <span>Tax (5%)</span>
                                <span>₹${bill.tax.toFixed(2)}</span>
                            </div>
                            <div class="summary-row total">
                                <span>Total</span>
                                <span>₹${bill.total.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="payment-status ${bill.status}">
                            <i class="material-icons">${bill.status === 'success' ? 'check_circle' : 'error'}</i>
                            <span>${bill.status === 'success' ? 'Paid' : 'Failed'}</span>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', billHtml);
            });
        }

        function clearBillHistory() {
            if (confirm('Are you sure you want to clear all bill history?')) {
                localStorage.removeItem('bills');
                document.getElementById('bills-container').innerHTML = '';
            }
        }

        // Function to store bill in localStorage
        function storeBill(bill) {
            // Get existing bills
            const bills = JSON.parse(localStorage.getItem('bills')) || [];
            
            // Add new bill to the beginning of the array (newest first)
            bills.unshift(bill);
            
            // Store updated bills
            localStorage.setItem('bills', JSON.stringify(bills));
            
            // Update bills display if bills section is active
            if (document.querySelector('.bills-section.active')) {
                filterBills('all');
            }
        }

        // Function to add bills section to sidebar
        function addBillsToSidebar() {
            const billsCount = JSON.parse(localStorage.getItem('bills') || '[]').length;
            const billsItem = document.querySelector('.sidebar-menu-item.bills');
            
            if (billsItem) {
                // Add bills count badge if there are bills
                if (billsCount > 0) {
                    billsItem.innerHTML = `
                        <i class="material-icons">receipt</i>
                        <span>My Bills</span>
                        <span class="bills-badge">${billsCount}</span>
                    `;
                }
            }
        }

        // Initialize bills section
        document.addEventListener('DOMContentLoaded', () => {
            addBillsToSidebar();
            // Initialize bills display with all bills
            const bills = JSON.parse(localStorage.getItem('bills') || '[]');
            displayBills(bills);
        });

        // Add event listeners for payment form inputs
        document.addEventListener('DOMContentLoaded', function() {
            // Format card number with spaces
            const cardNumberInput = document.getElementById('card-number');
            if (cardNumberInput) {
                cardNumberInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    let formattedValue = '';
                    
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) {
                            formattedValue += ' ';
                        }
                        formattedValue += value[i];
                    }
                    
                    e.target.value = formattedValue;
                });
            }
            
            // Format expiry date
            const cardExpiryInput = document.getElementById('card-expiry');
            if (cardExpiryInput) {
                cardExpiryInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    
                    if (value.length >= 2) {
                        value = value.substring(0, 2) + '/' + value.substring(2);
                    }
                    
                    e.target.value = value;
                });
            }
            
            // Restrict CVV to numbers only
            const cardCvvInput = document.getElementById('card-cvv');
            if (cardCvvInput) {
                cardCvvInput.addEventListener('input', function(e) {
                    e.target.value = e.target.value.replace(/\D/g, '');
                });
            }
        });

        // Add these functions
        function filterFood(category) {
            const filterOptions = document.querySelectorAll('.filter-option');
            filterOptions.forEach(option => {
                if (option.getAttribute('data-category') === category) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });

            const foodItemsGrid = document.getElementById('food-items-grid');
            if (!foodItemsGrid) return;

            const allItems = [];
            
            // Collect all menu items from all restaurants
            restaurants.forEach(restaurant => {
                restaurant.menu.forEach(item => {
                    allItems.push({
                        ...item,
                        restaurantName: restaurant.name,
                        restaurantRating: restaurant.rating
                    });
                });
            });

            // Display all items
            displayAllFoodItems(allItems);
        }

        function displayAllFoodItems(items) {
            const foodItemsGrid = document.getElementById('food-items-grid');
            if (!foodItemsGrid) return;

            foodItemsGrid.innerHTML = items.map((item, index) => `
                <div class="food-item-card" data-item-name="${item.name}" data-category="${item.category}" style="animation-delay: ${index * 0.05}s">
                    <div class="food-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="food-item-badge">${item.restaurantName}</div>
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                    </div>
                    <div class="food-item-info">
                        <div class="food-item-header">
                            <h3 class="food-item-title">${item.name}</h3>
                            <span class="food-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="food-item-meta">
                            <div class="food-item-rating">
                                <div class="food-item-stars">
                                    ${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}
                                </div>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="food-item-time">
                                <i class="material-icons">schedule</i>
                                <span>20-30 min</span>
                            </div>
                        </div>
                        <div class="food-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Enhanced updateWishlistUI function
        function updateWishlistUI() {
            const wishlistContainer = document.querySelector('.wishlist-items');
            if (!wishlistContainer) return;

            if (wishlistItems.length === 0) {
                wishlistContainer.innerHTML = `
                    <div class="empty-wishlist">
                        <i class="material-icons">sentiment_very_dissatisfied</i>
                        <p>Your wishlist is empty</p>
                        <button class="btn" onclick="togglePanel('wishlist')">Continue Shopping</button>
                    </div>
                `;
                return;
            }

            wishlistContainer.innerHTML = wishlistItems.map(item => `
                <div class="wishlist-card" data-item-name="${item.name}">
                    <div class="wishlist-card-image">
                        <img src="${item.image}" alt="${item.name}">
                        <button class="remove-from-wishlist" onclick="removeFromWishlist('${item.name}')" style="opacity: 1; transform: translateY(0);">
                            <i class="material-icons">close</i>
                        </button>
                    </div>
                    <div class="wishlist-card-info">
                        <h3>${item.name}</h3>
                        <div class="wishlist-card-price">$${item.price.toFixed(2)}</div>
                        <button class="move-to-cart-btn" onclick="moveToCart('${item.name}')">
                            <i class="material-icons">shopping_cart</i>
                            Add to Cart
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Enhanced updateCart function
        function updateCart() {
            const cartItems = document.getElementById('cart-items');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartTotal = document.getElementById('cart-total');
            
            if (!cartItems) return;
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-cart">
                        <i class="material-icons">shopping_cart</i>
                        <p>Your cart is empty</p>
                        <button class="btn" onclick="togglePanel('cart')">Continue Shopping</button>
                    </div>
                `;
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-wishlist-item">
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-wishlist-item-info">
                        <h3 class="cart-wishlist-item-title">${item.name}</h3>
                        <p class="cart-wishlist-item-price">$${item.price.toFixed(2)}</p>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', ${(item.quantity || 1) - 1})">-</button>
                            <input type="number" class="quantity-input" value="${item.quantity || 1}" min="1" onchange="updateQuantity('${item.name}', this.value)">
                            <button class="quantity-btn" onclick="updateQuantity('${item.name}', ${(item.quantity || 1) + 1})">+</button>
                        </div>
                    </div>
                    <button class="remove-item" onclick="removeFromCart('${item.name}')">✕</button>
                </div>
            `).join('');
            
            // Update cart counts
            updateCartBadge();
            
            // Calculate totals
            const subtotal = cart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
            const total = subtotal + (selectedOrderType === 'delivery' ? deliveryFee : 0);
            
            if (cartSubtotal) {
                cartSubtotal.textContent = `$${subtotal.toFixed(2)}`;
            }
            
            if (cartTotal) {
                cartTotal.textContent = `$${total.toFixed(2)}`;
            }
        }

        // Add these functions
        function displayFoodItems() {
            const foodItemsGrid = document.querySelector('.food-items-grid');
            if (!foodItemsGrid) return;
            
            const allItems = [];
            
            // Collect all menu items from all restaurants
            restaurants.forEach(restaurant => {
                restaurant.menu.forEach(item => {
                    allItems.push({
                        ...item,
                        restaurantName: restaurant.name,
                        restaurantRating: restaurant.rating
                    });
                });
            });

            // Display all items
            displayAllFoodItems(allItems);
        }

        function refreshRecommendations() {
            const recommendationsGrid = document.getElementById('recommendations-grid');
            if (!recommendationsGrid) return;

            // Get all food items
            const allFoodItems = restaurants.flatMap(restaurant => 
                restaurant.menu.map(item => ({
                    ...item,
                    restaurantName: restaurant.name,
                    restaurantRating: restaurant.rating
                }))
            );

            // Sort by rating and get top 5
            const recommendedItems = [...allFoodItems]
                .sort((a, b) => b.restaurantRating - a.restaurantRating)
                .slice(0, 5);

            recommendationsGrid.innerHTML = recommendedItems.map(item => `
                <div class="food-item-card">
                    <div class="food-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="food-item-badge">${item.restaurantName}</div>
                    </div>
                    <div class="food-item-info">
                        <div class="food-item-header">
                            <h3 class="food-item-title">${item.name}</h3>
                            <span class="food-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="food-item-rating">
                            <div class="food-item-stars">
                                ${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}
                            </div>
                            <span>${item.restaurantRating}</span>
                        </div>
                        <div class="food-item-time">
                            <i class="time-icon">⏱️</i>
                            <span>15-20 min</span>
                        </div>
                        <div class="food-item-actions">
                            <button class="action-btn add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">Add to Cart</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showProfile() {
            showToast('Profile section coming soon!');
        }

        function sortItems(criteria) {
            const foodItemsGrid = document.getElementById('food-items-grid');
            if (!foodItemsGrid) return;
            
            // Update active sort option
            const sortOptions = document.querySelectorAll('.pre-row-card');
            sortOptions.forEach(option => {
                option.classList.remove('active');
                if (option.querySelector('span').textContent.toLowerCase().includes(criteria.toLowerCase()) ||
                    (criteria === 'price-low' && option.querySelector('span').textContent.includes('Low to High')) ||
                    (criteria === 'price-high' && option.querySelector('span').textContent.includes('High to Low'))) {
                    option.classList.add('active');
                }
            });
            
            // Get all food items from all restaurants
            const allFoodItems = [];
            restaurants.forEach(restaurant => {
                restaurant.menu.forEach(item => {
                    // Add additional properties for sorting
                    const deliveryTime = Math.floor(Math.random() * 20) + 15; // Random delivery time between 15-35 min
                    const popularity = Math.floor(Math.random() * 100); // Random popularity score
                    
                    allFoodItems.push({
                        ...item,
                        restaurantName: restaurant.name,
                        restaurantRating: restaurant.rating,
                        deliveryTime: deliveryTime,
                        popularity: popularity
                    });
                });
            });
            
            // Sort items based on criteria
            let sortedItems = [...allFoodItems];
            
            switch(criteria) {
                case 'rating':
                    sortedItems.sort((a, b) => b.restaurantRating - a.restaurantRating);
                    break;
                case 'price-low':
                    sortedItems.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    sortedItems.sort((a, b) => b.price - a.price);
                    break;
                case 'delivery':
                    sortedItems.sort((a, b) => a.deliveryTime - b.deliveryTime);
                    break;
                case 'popularity':
                    sortedItems.sort((a, b) => b.popularity - a.popularity);
                    break;
                default:
                    // No sorting
                    break;
            }
            
            // Clear current food items
            foodItemsGrid.innerHTML = '';
            
            // Display sorted items with animation
            sortedItems.forEach((item, index) => {
                const foodItem = document.createElement('div');
                foodItem.className = 'food-item-card';
                foodItem.setAttribute('data-item-name', item.name);
                foodItem.setAttribute('data-category', item.category);
                foodItem.style.animationDelay = `${index * 0.05}s`;
                
                // Determine delivery time label based on sorting criteria
                let deliveryTimeLabel = `${item.deliveryTime} min`;
                if (criteria === 'delivery' && index < 5) {
                    deliveryTimeLabel = `<span class="fast-delivery">${item.deliveryTime} min</span>`;
                }
                
                // Determine popularity badge
                const popularityBadge = criteria === 'popularity' && index < 3 ? 
                    `<div class="popularity-badge"><i class="material-icons">whatshot</i> Popular</div>` : '';
                
                foodItem.innerHTML = `
                    <div class="food-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="food-item-badge">${item.restaurantName}</div>
                        ${popularityBadge}
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                    </div>
                    <div class="food-item-info">
                        <div class="food-item-header">
                            <h3 class="food-item-title">${item.name}</h3>
                            <span class="food-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="food-item-meta">
                            <div class="food-item-rating">
                                <div class="food-item-stars">
                                    ${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}
                                </div>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="food-item-time">
                                <i class="material-icons">schedule</i>
                                <span>${deliveryTimeLabel}</span>
                            </div>
                        </div>
                        <div class="food-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;
                
                foodItemsGrid.appendChild(foodItem);
            });
            
            // Show toast notification
            showToast(`Food items sorted by ${criteria.replace('-', ' ')}`, 'info');
        }

        function toggleFilter(filterType) {
            const filterOption = event.target.closest('.filter-option');
            filterOption.classList.toggle('active');
            applyFilters();
        }

        // Recommendations scroll
        function scrollRecommendations(direction) {
            const container = document.querySelector('.recommendations-grid');
            const scrollAmount = 300;
            
            if (direction === 'left') {
                container.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            } else {
                container.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }

        // Search restaurants
        function searchRestaurants() {
            const searchInput = document.getElementById('restaurant-search');
            const searchTerm = searchInput.value.toLowerCase();
            const restaurantCards = document.querySelectorAll('.restaurant-card');
            let visibleCount = 0;

            restaurantCards.forEach(card => {
                const title = card.querySelector('.restaurant-title').textContent.toLowerCase();
                const cuisine = card.querySelector('.restaurant-cuisine span').textContent.toLowerCase();
                const location = card.querySelector('.restaurant-distance').textContent.toLowerCase();
                
                let matchesSearch = title.includes(searchTerm) || 
                                  cuisine.includes(searchTerm) || 
                                  location.includes(searchTerm);
                
                let matchesFilters = true;
                
                // Check rating filter
                if (activeFilters.rating) {
                    const rating = parseFloat(card.querySelector('.restaurant-rating span:last-child').textContent);
                    matchesFilters = matchesFilters && rating >= 4.5;
                }
                
                // Check delivery filter
                if (activeFilters.delivery) {
                    const deliveryTime = card.querySelector('.restaurant-delivery span').textContent;
                    const time = parseInt(deliveryTime);
                    matchesFilters = matchesFilters && time <= 30;
                }
                
                // Check offers filter
                if (activeFilters.offers) {
                    const offerBadge = card.querySelector('.restaurant-offer-badge');
                    matchesFilters = matchesFilters && offerBadge !== null;
                }
                
                // Check veg filter
                if (activeFilters.veg) {
                    const vegBadge = card.querySelector('.restaurant-veg');
                    matchesFilters = matchesFilters && vegBadge !== null;
                }
                
                if (matchesSearch && matchesFilters) {
                    card.style.display = 'block';
                    visibleCount++;
                } else {
                    card.style.display = 'none';
                }
            });
            
            // Show/hide no results message
            const noResults = document.getElementById('no-results');
            if (visibleCount === 0) {
                if (!noResults) {
                    const message = document.createElement('div');
                    message.id = 'no-results';
                    message.className = 'no-results-message';
                    message.innerHTML = `
                        <i class="material-icons">search_off</i>
                        <p>No restaurants found matching your criteria</p>
                        <button onclick="clearAllFilters()">Clear All Filters</button>
                    `;
                    document.querySelector('.restaurant-grid').appendChild(message);
                }
            } else if (noResults) {
                noResults.remove();
            }
        }

        function clearSearch() {
            const searchInput = document.getElementById('restaurant-search');
            searchInput.value = '';
            searchRestaurants();
        }

        function clearAllFilters() {
            // Reset active filters
            activeFilters = {
                rating: false,
                delivery: false,
                offers: false,
                veg: false
            };
            
            // Remove active class from all filter buttons
            document.querySelectorAll('.filter-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // Clear search input
            clearSearch();
        }

        function filterByRating() {
            const filterOption = event.target.closest('.filter-option');
            activeFilters.rating = !activeFilters.rating;
            filterOption.classList.toggle('active');
            searchRestaurants();
        }

        function filterByDelivery() {
            const filterOption = event.target.closest('.filter-option');
            activeFilters.delivery = !activeFilters.delivery;
            filterOption.classList.toggle('active');
            searchRestaurants();
        }

        function filterByOffers() {
            const filterOption = event.target.closest('.filter-option');
            activeFilters.offers = !activeFilters.offers;
            filterOption.classList.toggle('active');
            searchRestaurants();
        }

        function filterByVeg() {
            const filterOption = event.target.closest('.filter-option');
            activeFilters.veg = !activeFilters.veg;
            filterOption.classList.toggle('active');
            searchRestaurants();
        }

        // Add event listener for search input
        document.getElementById('restaurant-search').addEventListener('input', searchRestaurants);

        // Add click handlers for search filters
        document.querySelectorAll('.search-filter').forEach(filter => {
            filter.addEventListener('click', function() {
                // Remove active class from all filters
                document.querySelectorAll('.search-filter').forEach(f => f.classList.remove('active'));
                // Add active class to clicked filter
                this.classList.add('active');
                // Add your filter logic here
            });
        });

        // Add this function to display all menu items when the page loads
        function displayAllMenuItems() {
            const menuItems = document.getElementById('menu-items');
            if (!menuItems) return;

            const allMenuItems = restaurants.flatMap(restaurant => 
                restaurant.menu.map(item => ({
                    ...item,
                    restaurantName: restaurant.name,
                    restaurantRating: restaurant.rating
                }))
            );

            menuItems.innerHTML = allMenuItems.map((item, index) => `
                <div class="menu-item-card" style="animation-delay: ${index * 0.1}s">
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                        <span class="restaurant-badge">${item.restaurantName}</span>
                    </div>
                    <div class="menu-item-info">
                        <div class="menu-item-header">
                            <h3 class="menu-item-title">${item.name}</h3>
                            <span class="menu-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="menu-item-meta">
                            <div class="menu-item-rating">
                                <span class="stars">${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}</span>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="menu-item-time">
                                <i class="material-icons">access_time</i>
                                <span>30-40 min</span>
                            </div>
                        </div>
                        <div class="menu-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterMenuItems(category) {
            const menuCategories = document.querySelectorAll('.menu-category');
            menuCategories.forEach(cat => {
                if (cat.textContent.toLowerCase().includes(category)) {
                    cat.classList.add('active');
                } else {
                    cat.classList.remove('active');
                }
            });

            const menuItems = document.getElementById('menu-items');
            if (!menuItems) return;

            const allMenuItems = restaurants.flatMap(restaurant => 
                restaurant.menu.map(item => ({
                    ...item,
                    restaurantName: restaurant.name,
                    restaurantRating: restaurant.rating
                }))
            );

            const filteredItems = category === 'all' 
                ? allMenuItems 
                : allMenuItems.filter(item => item.category === category);

            menuItems.innerHTML = filteredItems.map((item, index) => `
                <div class="menu-item-card" style="animation-delay: ${index * 0.1}s">
                    <div class="menu-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                        <span class="restaurant-badge">${item.restaurantName}</span>
                    </div>
                    <div class="menu-item-info">
                        <div class="menu-item-header">
                            <h3 class="menu-item-title">${item.name}</h3>
                            <span class="menu-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="menu-item-meta">
                            <div class="menu-item-rating">
                                <span class="stars">${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}</span>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="menu-item-time">
                                <i class="material-icons">access_time</i>
                                <span>30-40 min</span>
                            </div>
                        </div>
                        <div class="menu-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Add this function for restaurant scrolling
        function scrollRestaurants(direction) {
            const container = document.querySelector('.restaurant-container');
            const scrollAmount = 400; // Adjust this value as needed
            
            if (direction === 'left') {
                container.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            } else {
                container.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }

        // Location access functionality
        function requestLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        // Success callback
                        getLocationName(position.coords.latitude, position.coords.longitude);
                        showToast('Location updated successfully');
                    },
                    error => {
                        // Error callback
                        console.error('Error getting location:', error);
                        showToast('Could not access your location. Please check your permissions.');
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 5000,
                        maximumAge: 0
                    }
                );
            } else {
                showToast('Geolocation is not supported by your browser');
            }
        }

        // Get location name from coordinates using reverse geocoding
        function getLocationName(latitude, longitude) {
            // Using a simple approach with a mock location for demonstration
            // In a real app, you would use a reverse geocoding API like Google Maps or Nominatim
            
            // Simulate API call with timeout
            setTimeout(() => {
                // Mock data - in real app this would come from the API
                const locationName = "Mumbai, Maharashtra";
                document.getElementById('location-name').textContent = locationName;
                
                // Store in localStorage for persistence
                localStorage.setItem('userLocation', locationName);
            }, 1000);
            
            // Uncomment and use this in a real application with an actual API
            /*
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`)
                .then(response => response.json())
                .then(data => {
                    const locationName = data.address.city || data.address.town || data.address.village || data.address.state;
                    document.getElementById('location-name').textContent = locationName;
                    localStorage.setItem('userLocation', locationName);
                })
                .catch(error => {
                    console.error('Error getting location name:', error);
                    showToast('Could not determine your location name');
                });
            */
        }

        // Load saved location on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved location if available
            const savedLocation = localStorage.getItem('userLocation');
            if (savedLocation) {
                document.getElementById('location-name').textContent = savedLocation;
            }
            
            // Other existing DOMContentLoaded code...
        });

        // Function to filter food items based on category
        function filterFood(category) {
            const foodItemsGrid = document.getElementById('food-items-grid');
            if (!foodItemsGrid) return;
            
            // Update active filter
            const filterOptions = document.querySelectorAll('.filter-option');
            filterOptions.forEach(option => {
                option.classList.remove('active');
                if (option.getAttribute('data-category') === category) {
                    option.classList.add('active');
                }
            });
            
            // Get all food items from all restaurants
            const allFoodItems = [];
            restaurants.forEach(restaurant => {
                restaurant.menu.forEach(item => {
                    allFoodItems.push({
                        ...item,
                        restaurantName: restaurant.name,
                        restaurantRating: restaurant.rating
                    });
                });
            });
            
            // Filter items based on category
            let filteredItems = [];
            if (category === 'all') {
                filteredItems = allFoodItems;
            } else {
                filteredItems = allFoodItems.filter(item => item.category === category);
            }
            
            // Clear current food items
            foodItemsGrid.innerHTML = '';
            
            // If no items found, add a default item for the category
            if (filteredItems.length === 0) {
                const defaultItems = getDefaultItemsForCategory(category);
                filteredItems = defaultItems;
            }
            
            // Display filtered items with animation
            filteredItems.forEach((item, index) => {
                const foodItem = document.createElement('div');
                foodItem.className = 'food-item-card';
                foodItem.setAttribute('data-item-name', item.name);
                foodItem.setAttribute('data-category', item.category);
                foodItem.style.animationDelay = `${index * 0.05}s`;
                
                foodItem.innerHTML = `
                    <div class="food-item-image">
                        <img src="${item.image}" alt="${item.name}">
                        <div class="food-item-badge">${item.restaurantName}</div>
                        <button class="wishlist-btn ${wishlistItems.some(w => w.name === item.name) ? 'active' : ''}" 
                                onclick="addToWishlist('${item.name}', ${item.price}, '${item.image}', '${item.category}')">
                            <i class="material-icons">
                                ${wishlistItems.some(w => w.name === item.name) ? 'favorite' : 'favorite_border'}
                            </i>
                        </button>
                    </div>
                    <div class="food-item-info">
                        <div class="food-item-header">
                            <h3 class="food-item-title">${item.name}</h3>
                            <span class="food-item-price">$${item.price.toFixed(2)}</span>
                        </div>
                        <div class="food-item-meta">
                            <div class="food-item-rating">
                                <div class="food-item-stars">
                                    ${'★'.repeat(Math.floor(item.restaurantRating))}${'☆'.repeat(5 - Math.floor(item.restaurantRating))}
                                </div>
                                <span>${item.restaurantRating}</span>
                            </div>
                            <div class="food-item-time">
                                <i class="material-icons">schedule</i>
                                <span>20-30 min</span>
                            </div>
                        </div>
                        <div class="food-item-actions">
                            <button class="add-to-cart" onclick="addToCart('${item.name}', ${item.price}, '${item.image}')">
                                <i class="material-icons">shopping_cart</i>
                                Add to Cart
                            </button>
                        </div>
                    </div>
                `;
                
                foodItemsGrid.appendChild(foodItem);
            });
            
            // Show toast notification
            showToast(`Food items filtered by ${category}`, 'info');
        }
        
        // Function to get default items for categories with no items
        function getDefaultItemsForCategory(category) {
            const defaultItems = {
                burgers: {
                    name: "Classic Cheeseburger",
                    price: 8.99,
                    category: "burgers",
                    image: "https://images.unsplash.com/photo-1568901346375-23c9450c58cd",
                    restaurantName: "Burger House",
                    restaurantRating: 4.6
                },
                pizza: {
                    name: "Margherita Pizza",
                    price: 12.99,
                    category: "pizza",
                    image: "https://images.unsplash.com/photo-1604382355076-af4b0eb60143",
                    restaurantName: "Pizza Palace",
                    restaurantRating: 4.7
                },
                pasta: {
                    name: "Spaghetti Carbonara",
                    price: 11.99,
                    category: "pasta",
                    image: "https://images.unsplash.com/photo-1546549032-9571cd80d66df",
                    restaurantName: "Pasta Paradise",
                    restaurantRating: 4.5
                },
                salads: {
                    name: "Caesar Salad",
                    price: 7.99,
                    category: "salads",
                    image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd",
                    restaurantName: "Green Garden",
                    restaurantRating: 4.3
                },
                desserts: {
                    name: "Chocolate Cake",
                    price: 6.99,
                    category: "desserts",
                    image: "https://images.unsplash.com/photo-1578985545062-69928b1d9587",
                    restaurantName: "Sweet Treats",
                    restaurantRating: 4.8
                },
                drinks: {
                    name: "Fresh Fruit Smoothie",
                    price: 4.99,
                    category: "drinks",
                    image: "https://images.unsplash.com/photo-1505252585461-04db1eb84625",
                    restaurantName: "Juice Junction",
                    restaurantRating: 4.4
                },
                vegan: {
                    name: "Vegan Buddha Bowl",
                    price: 10.99,
                    category: "vegan",
                    image: "https://images.unsplash.com/photo-1512621776951-a57141f2eefd",
                    restaurantName: "Green Garden",
                    restaurantRating: 4.5
                },
                breakfast: {
                    name: "Avocado Toast",
                    price: 8.99,
                    category: "breakfast",
                    image: "https://images.unsplash.com/photo-1603046891744-76e6300f6ab4",
                    restaurantName: "Morning Delight",
                    restaurantRating: 4.6
                },
                seafood: {
                    name: "Grilled Salmon",
                    price: 15.99,
                    category: "seafood",
                    image: "https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2",
                    restaurantName: "Ocean Catch",
                    restaurantRating: 4.7
                },
                asian: {
                    name: "Chicken Pad Thai",
                    price: 12.99,
                    category: "asian",
                    image: "https://images.unsplash.com/photo-1559314809-0d155014e29e",
                    restaurantName: "Asian Fusion",
                    restaurantRating: 4.5
                },
                biryani: {
                    name: "Chicken Biryani",
                    price: 13.99,
                    category: "biryani",
                    image: "https://images.unsplash.com/photo-1589302168068-964664d93587",
                    restaurantName: "Spice Garden",
                    restaurantRating: 4.8
                },
                mexican: {
                    name: "Beef Tacos",
                    price: 9.99,
                    category: "mexican",
                    image: "https://images.unsplash.com/photo-1565299585323-38d6b0865b47",
                    restaurantName: "Taco Fiesta",
                    restaurantRating: 4.5
                }
            };
            
            return [defaultItems[category] || defaultItems.burgers];
        }

        // Logout function
        function logout() {
            // Show confirmation dialog
            if (confirm('Are you sure you want to logout?')) {
                // Redirect to login page
                window.location.href = '/logout';
            }
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Simulate payment process
        function proceedToCheckout() {
            openModal('paymentModal');
            const form = document.getElementById('payment-form');
            form.onsubmit = function(event) {
                event.preventDefault();
                document.getElementById('payment-confirmation').style.display = 'block';
                form.style.display = 'none';
            };
        }

        function showPaymentModal() {
            // Check if cart is empty
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length === 0) {
                showToast('Your cart is empty. Please add items to proceed.', 'error');
                return;
            }

            const modal = document.getElementById('paymentModal');
            const orderItems = document.getElementById('payment-order-items');
            const subtotal = document.getElementById('payment-subtotal');
            const tax = document.getElementById('payment-tax');
            const total = document.getElementById('payment-total');
            
            // Calculate totals
            const subtotalAmount = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const taxAmount = subtotalAmount * 0.05;
            const totalAmount = subtotalAmount + taxAmount + 40; // Adding delivery fee
            
            // Update order items
            orderItems.innerHTML = cart.map(item => `
                <div class="payment-item">
                    <span>${item.name} x ${item.quantity}</span>
                    <span>₹${(item.price * item.quantity).toFixed(2)}</span>
                </div>
            `).join('');
            
            // Update totals
            subtotal.textContent = `₹${subtotalAmount.toFixed(2)}`;
            tax.textContent = `₹${taxAmount.toFixed(2)}`;
            total.textContent = `₹${totalAmount.toFixed(2)}`;
            
            // Show modal
            modal.style.display = 'flex';
        }

        function closePaymentModal() {
            const modal = document.getElementById('paymentModal');
            modal.style.display = 'none';
        }

        function processPayment() {
            // Show loading animation
            const loadingOverlay = document.querySelector('.loading-overlay');
            loadingOverlay.style.display = 'flex';
            
            // Simulate payment processing
            setTimeout(() => {
                // Hide loading animation
                loadingOverlay.style.display = 'none';
                
                // Get payment details
                const orderId = 'ORD' + Math.floor(Math.random() * 1000000);
                const amount = calculateOrderTotal();
                const method = document.querySelector('input[name="payment-method"]:checked').value;
                
                // Show success animation
                const successAnimation = document.getElementById('paymentSuccessAnimation');
                successAnimation.style.display = 'flex';
                successAnimation.style.opacity = '1';
                
                // Update success details
                document.getElementById('success-order-id').textContent = orderId;
                document.getElementById('success-amount').textContent = `₹${amount.toFixed(2)}`;
                document.getElementById('success-method').textContent = method;
                
                // Create bill object
                const bill = {
                    id: orderId,
                    date: new Date().toISOString(),
                    items: JSON.parse(localStorage.getItem('cartItems') || '[]'),
                    subtotal: amount.subtotal,
                    deliveryFee: amount.deliveryFee,
                    tax: amount.tax,
                    total: amount.total,
                    paymentMethod: method,
                    status: 'success'
                };
                
                // Store bill
                storeBill(bill);
                
                // Clear cart
                localStorage.removeItem('cartItems');
                updateCartCount();
                
                // Close payment modal
                closePaymentModal();
                
                // Show success modal after animation
                setTimeout(() => {
                    const paymentSuccess = document.querySelector('.payment-success');
                    paymentSuccess.classList.add('active');
                    
                    // Hide animation after 2 seconds
                    setTimeout(() => {
                        successAnimation.style.opacity = '0';
                        setTimeout(() => {
                            successAnimation.style.display = 'none';
                        }, 300);
                    }, 2000);
                }, 500);
            }, 2000);
        }

        function closePaymentSuccess() {
            const paymentSuccess = document.querySelector('.payment-success');
            paymentSuccess.classList.remove('active');
            
            // Show bills section
            toggleBillsSection();
        }

        function viewOrderDetails() {
            closePaymentSuccess();
            toggleBillsSection();
        }

        function storeBill(bill) {
            // Get existing bills
            const bills = JSON.parse(localStorage.getItem('bills')) || [];
            
            // Add new bill to the beginning of the array (newest first)
            bills.unshift(bill);
            
            // Store updated bills
            localStorage.setItem('bills', JSON.stringify(bills));
            
            // Update bills display if bills section is active
            if (document.querySelector('.bills-section.active')) {
                filterBills('all');
            }
        }

        function clearBillHistory() {
            if (confirm('Are you sure you want to clear all bill history?')) {
                localStorage.removeItem('bills');
                document.getElementById('bills-container').innerHTML = '';
            }
        }

        function displayBills(bills) {
            const container = document.getElementById('bills-container');
            container.innerHTML = '';
            
            if (bills.length === 0) {
                container.innerHTML = `
                    <div class="empty-bills">
                        <i class="material-icons">receipt</i>
                        <p>No bills found</p>
                    </div>
                `;
                return;
            }
            
            bills.forEach(bill => {
                const billDate = new Date(bill.date);
                const formattedDate = billDate.toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const billHtml = `
                    <div class="bill-card">
                        <div class="bill-header">
                            <div class="bill-id">Order #${bill.id}</div>
                            <div class="bill-date">${formattedDate}</div>
                        </div>
                        <div class="bill-items">
                            ${bill.items.map(item => `
                                <div class="bill-item">
                                    <span class="bill-item-name">${item.name} x ${item.quantity}</span>
                                    <span class="bill-item-price">₹${(item.price * item.quantity).toFixed(2)}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="bill-total">
                            <div class="summary-row">
                                <span>Subtotal</span>
                                <span>₹${bill.subtotal.toFixed(2)}</span>
                            </div>
                            <div class="summary-row">
                                <span>Delivery Fee</span>
                                <span>₹${bill.deliveryFee.toFixed(2)}</span>
                            </div>
                            <div class="summary-row">
                                <span>Tax (5%)</span>
                                <span>₹${bill.tax.toFixed(2)}</span>
                            </div>
                            <div class="summary-row total">
                                <span>Total</span>
                                <span>₹${bill.total.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="payment-status ${bill.status}">
                            <i class="material-icons">${bill.status === 'success' ? 'check_circle' : 'error'}</i>
                            <span>${bill.status === 'success' ? 'Paid' : 'Failed'}</span>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', billHtml);
            });
        }

        function filterBills(filter) {
            const bills = JSON.parse(localStorage.getItem('bills') || '[]');
            const now = new Date();
            
            let filteredBills = bills;
            if (filter !== 'all') {
                filteredBills = bills.filter(bill => {
                    const billDate = new Date(bill.date);
                    const diffTime = now - billDate;
                    const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    
                    switch (filter) {
                        case 'today':
                            return diffDays === 0;
                        case 'week':
                            return diffDays <= 7;
                        case 'month':
                            return diffDays <= 30;
                        default:
                            return true;
                    }
                });
            }
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(filter)) {
                    btn.classList.add('active');
                }
            });
            
            displayBills(filteredBills);
        }

        // Initialize payment modal
        document.addEventListener('DOMContentLoaded', () => {
            // Add event listener to proceed to checkout button
            const checkoutBtn = document.querySelector('.checkout-btn');
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', showPaymentModal);
            }
            
            // Initialize bills display
            displayBills('all');
        });

        function calculateOrderTotal() {
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            let subtotal = 0;
            
            cartItems.forEach(item => {
                subtotal += parseFloat(item.price) * parseInt(item.quantity);
            });
            
            const deliveryFee = 40;
            const tax = subtotal * 0.05; // 5% tax
            const total = subtotal + deliveryFee + tax;
            
            return {
                subtotal: subtotal.toFixed(2),
                deliveryFee: deliveryFee.toFixed(2),
                tax: tax.toFixed(2),
                total: total.toFixed(2)
            };
        }

        function showPaymentModal() {
            const paymentModal = document.getElementById('paymentModal');
            const orderItems = document.getElementById('payment-order-items');
            const orderTotals = document.querySelector('.order-totals');
            
            // Clear previous items
            orderItems.innerHTML = '';
            
            // Get cart items
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            
            // Calculate totals
            const totals = calculateOrderTotal();
            
            // Add items to order summary
            cartItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'payment-order-item';
                itemElement.innerHTML = `
                    <div class="payment-item-info">
                        <span class="payment-item-name">${item.name}</span>
                        <span class="payment-item-quantity">x${item.quantity}</span>
                    </div>
                    <span class="payment-item-price">₹${(parseFloat(item.price) * parseInt(item.quantity)).toFixed(2)}</span>
                `;
                orderItems.appendChild(itemElement);
            });
            
            // Update totals
            orderTotals.innerHTML = `
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span>₹${totals.subtotal}</span>
                </div>
                <div class="summary-row">
                    <span>Delivery Fee</span>
                    <span>₹${totals.deliveryFee}</span>
                </div>
                <div class="summary-row">
                    <span>Tax (5%)</span>
                    <span>₹${totals.tax}</span>
                </div>
                <div class="summary-row total">
                    <span>Total Amount</span>
                    <span>₹${totals.total}</span>
                </div>
            `;
            
            paymentModal.style.display = 'block';
        }

        function processPayment() {
            const loadingOverlay = document.querySelector('.loading-overlay');
            const paymentSuccess = document.querySelector('.payment-success');
            const selectedMethod = document.querySelector('input[name="payment-method"]:checked');
            
            // Validate payment method selection
            if (!selectedMethod) {
                showToast('Please select a payment method', 'error');
                return;
            }
            
            // Get cart items and validate cart
            const cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
            if (cartItems.length === 0) {
                showToast('Your cart is empty', 'error');
                return;
            }
            
            // Validate payment details based on selected method
            const paymentValid = validatePaymentDetails(selectedMethod.value);
            if (!paymentValid) {
                return;
            }
            
            // Show loading animation with smooth transition
            loadingOverlay.style.opacity = '0';
            loadingOverlay.style.display = 'flex';
            setTimeout(() => {
                loadingOverlay.style.opacity = '1';
            }, 10);
            
            // Generate transaction ID for payment tracking
            const transactionId = generateTransactionId();
            
            // Simulate payment gateway processing
            simulatePaymentGateway(selectedMethod.value, transactionId)
                .then(response => {
                    // Process successful payment
                    processSuccessfulPayment(response, selectedMethod.value, cartItems);
                })
                .catch(error => {
                    // Handle payment failure
                    console.error('Payment failed:', error);
                    loadingOverlay.style.opacity = '0';
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                        showToast('Payment failed: ' + error.message, 'error');
                    }, 300);
                });
        }
        
        function generateTransactionId() {
            // Generate a unique transaction ID with timestamp and random string
            const timestamp = Date.now().toString(36);
            const randomStr = Math.random().toString(36).substring(2, 8).toUpperCase();
            return `TXN-${timestamp}-${randomStr}`;
        }
        
        function simulatePaymentGateway(paymentMethod, transactionId) {
            // Simulate a real payment gateway with promise-based API
            return new Promise((resolve, reject) => {
                // Simulate network delay and processing time (1.5-2.5 seconds)
                const processingTime = 1500 + Math.random() * 1000;
                
                setTimeout(() => {
                    // Success rate of 95% to simulate occasional payment failures
                    const isSuccessful = Math.random() > 0.05;
                    
                    if (isSuccessful) {
                        // Generate order ID for successful payment
                        const orderId = 'ORD' + Date.now().toString().slice(-6);
                        
                        resolve({
                            success: true,
                            orderId: orderId,
                            transactionId: transactionId,
                            paymentMethod: paymentMethod,
                            timestamp: new Date().toISOString(),
                            message: 'Payment processed successfully'
                        });
                    } else {
                        // Simulate different types of payment failures
                        const errorTypes = [
                            { code: 'PAYMENT_DECLINED', message: 'Payment was declined by the bank' },
                            { code: 'INSUFFICIENT_FUNDS', message: 'Insufficient funds in account' },
                            { code: 'GATEWAY_ERROR', message: 'Payment gateway error, please try again' }
                        ];
                        const error = errorTypes[Math.floor(Math.random() * errorTypes.length)];
                        
                        reject({
                            success: false,
                            errorCode: error.code,
                            message: error.message,
                            transactionId: transactionId
                        });
                    }
                }, processingTime);
            });
        }
        
        function processSuccessfulPayment(response, paymentMethod, cartItems) {
            const loadingOverlay = document.querySelector('.loading-overlay');
            const paymentSuccess = document.querySelector('.payment-success');
            
            // Calculate order total with precision handling
            const orderTotal = calculateOrderTotal();
            
            // Get additional order details
            const deliveryAddress = localStorage.getItem('userAddress') || 'Default Address';
            const orderType = document.querySelector('input[name="order-type"]:checked')?.id || 'delivery';
            const customerName = localStorage.getItem('userName') || 'Guest User';
            const customerPhone = localStorage.getItem('userPhone') || '';
            const customerEmail = localStorage.getItem('userEmail') || '';
            
            // Create comprehensive bill object with all necessary details
            const bill = {
                id: response.orderId,
                transactionId: response.transactionId,
                date: new Date().toISOString(),
                items: JSON.parse(JSON.stringify(cartItems)), // Deep copy to prevent reference issues
                itemCount: cartItems.reduce((total, item) => total + (parseInt(item.quantity) || 1), 0),
                subtotal: parseFloat(orderTotal.subtotal),
                deliveryFee: parseFloat(orderTotal.deliveryFee),
                tax: parseFloat(orderTotal.tax),
                total: parseFloat(orderTotal.total),
                paymentMethod: paymentMethod,
                status: 'success',
                restaurant: 'Foodie Haven',
                deliveryAddress: deliveryAddress,
                orderType: orderType,
                customerName: customerName,
                customerPhone: customerPhone,
                customerEmail: customerEmail,
                paymentTimestamp: response.timestamp,
                deliveryEstimate: generateDeliveryEstimate(orderType),
                orderNotes: localStorage.getItem('orderNotes') || '',
                paymentGatewayResponse: {
                    success: response.success,
                    message: response.message,
                    timestamp: response.timestamp
                }
            };
            
            // Ensure bill is properly stored using dedicated function
            const billStored = storeBillSecurely(bill);
            
            if (!billStored) {
                // If bill storage failed, show error and return
                loadingOverlay.style.opacity = '0';
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    showToast('Payment processed but there was an error saving your bill. Please contact support.', 'warning');
                }, 300);
                return;
            }
            
            // Hide loading overlay with smooth transition
            loadingOverlay.style.opacity = '0';
            setTimeout(() => {
                loadingOverlay.style.display = 'none';
                
                // Update success message with order details
                document.getElementById('success-order-id').textContent = response.orderId;
                document.getElementById('success-amount').textContent = '₹' + orderTotal.total.toFixed(2);
                document.getElementById('success-method').textContent = paymentMethod;
                
                // Force the payment success animation to display properly
                const successAnimation = document.getElementById('paymentSuccessAnimation');
                // Reset any previous state
                successAnimation.style.display = 'none';
                
                // Force a reflow to ensure animation works
                void successAnimation.offsetWidth;
                
                // Show animation with maximum visibility
                successAnimation.style.display = 'flex';
                successAnimation.style.opacity = '1';
                successAnimation.style.zIndex = '9999'; // Ensure it's above everything
                
                // Create confetti effect for success animation
                createConfettiEffect();
                
                // Show success message immediately
                paymentSuccess.classList.add('active');
                showToast('Payment successful! Your order has been placed.', 'success');
                
                // Hide animation after exactly 2 seconds
                setTimeout(() => {
                    // Fade out animation
                    successAnimation.style.opacity = '0';
                    setTimeout(() => {
                        successAnimation.style.display = 'none';
                    }, 300);
                }, 2000);
                
                // Clear cart data
                clearCartAfterPayment();
                
                // Close payment modal with animation
                const paymentModal = document.getElementById('paymentModal');
                if (paymentModal) {
                    paymentModal.classList.add('closing');
                    paymentModal.style.opacity = '0';
                    setTimeout(() => {
                        paymentModal.style.display = 'none';
                        setTimeout(() => {
                            paymentModal.classList.remove('closing');
                            paymentModal.style.opacity = '1';
                        }, 100);
                    }, 300);
                }
                
                // Auto close success message after 3 seconds
                setTimeout(() => {
                    closePaymentSuccess();
                }, 3000);
                
                // Send confirmation notification (could be expanded to email/SMS)
                sendOrderConfirmation(bill);
            }, 300);
        }
        
        function generateDeliveryEstimate(orderType) {
            const now = new Date();
            let deliveryTime;
            
            if (orderType === 'delivery') {
                // For delivery, estimate 30-45 minutes
                deliveryTime = new Date(now.getTime() + (30 + Math.floor(Math.random() * 15)) * 60000);
            } else if (orderType === 'pickup') {
                // For pickup, estimate 15-25 minutes
                deliveryTime = new Date(now.getTime() + (15 + Math.floor(Math.random() * 10)) * 60000);
            } else {
                // Default fallback
                deliveryTime = new Date(now.getTime() + 30 * 60000);
            }
            
            return {
                estimatedTime: deliveryTime.toISOString(),
                formattedTime: deliveryTime.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }),
                estimatedMinutes: Math.round((deliveryTime - now) / 60000)
            };
        }
        
        function sendOrderConfirmation(bill) {
            // This function could be expanded to send actual emails or SMS
            // For now, just log to console and store in localStorage for demo purposes
            console.log('Order confirmation for order #' + bill.id, bill);
            
            // Store last order details for potential future reference
            localStorage.setItem('lastOrderConfirmation', JSON.stringify({
                orderId: bill.id,
                timestamp: new Date().toISOString(),
                total: bill.total,
                items: bill.itemCount
            }));
        }
        
        function storeBillSecurely(bill) {
            try {
                // Validate bill object has required fields
                if (!bill || !bill.id || !bill.date || !bill.total || !Array.isArray(bill.items)) {
                    console.error('Invalid bill object:', bill);
                    showToast('Error: Invalid bill data format', 'error');
                    return false;
                }
                
                // Get existing bills with error handling
                let bills = [];
                try {
                    const storedBills = localStorage.getItem('bills');
                    if (storedBills) {
                        bills = JSON.parse(storedBills);
                        // Validate that bills is actually an array
                        if (!Array.isArray(bills)) {
                            console.error('Bills data corrupted, resetting to empty array');
                            bills = [];
                        }
                    }
                } catch (e) {
                    console.error('Error parsing bills from localStorage:', e);
                    // Clear corrupted data
                    localStorage.removeItem('bills');
                    bills = [];
                }
                
                // Check for duplicate bill ID (prevent double-charging)
                const existingBillIndex = bills.findIndex(existingBill => existingBill.id === bill.id);
                if (existingBillIndex !== -1) {
                    console.warn('Bill with ID already exists, updating instead of adding new:', bill.id);
                    // Update existing bill instead of adding duplicate
                    bills[existingBillIndex] = bill;
                } else {
                    // Add new bill to the beginning of the array (newest first)
                    bills.unshift(bill);
                }
                
                // Limit the number of stored bills to prevent localStorage overflow
                const MAX_STORED_BILLS = 100;
                if (bills.length > MAX_STORED_BILLS) {
                    bills = bills.slice(0, MAX_STORED_BILLS);
                }
                
                // Store updated bills with error handling
                try {
                    localStorage.setItem('bills', JSON.stringify(bills));
                } catch (storageError) {
                    // Handle potential localStorage quota exceeded error
                    console.error('Error storing bills in localStorage:', storageError);
                    
                    // Try to store with fewer bills if quota exceeded
                    if (bills.length > 20) {
                        bills = bills.slice(0, 20); // Keep only the 20 most recent bills
                        try {
                            localStorage.setItem('bills', JSON.stringify(bills));
                        } catch (e) {
                            console.error('Still failed to store bills after reducing count:', e);
                            return false;
                        }
                    } else {
                        return false;
                    }
                }
                
                // Create a backup of the bill in a separate storage key
                try {
                    localStorage.setItem('lastBill', JSON.stringify(bill));
                } catch (e) {
                    console.warn('Could not create bill backup:', e);
                    // Non-critical error, continue
                }
                
                // Update bills display if bills section is active
                if (document.querySelector('.bills-section.active')) {
                    filterBills('today'); // Show today's bills by default after new payment
                }
                
                // Update bills count in sidebar
                updateBillsCount();
                
                console.log('Bill stored successfully:', bill.id);
                return true;
            } catch (error) {
                console.error('Failed to store bill:', error);
                showToast('Error saving your bill. Please contact support.', 'error');
                return false;
            }
        }
        
        function clearCartAfterPayment() {
            try {
                // Clear cart data from localStorage
                localStorage.removeItem('cartItems');
                
                // Reset cart array
                cart = [];
                
                // Update cart UI
                updateCart();
                updateCartBadge();
                
                return true;
            } catch (error) {
                console.error('Error clearing cart:', error);
                return false;
            }
        }

        function closePaymentSuccess() {
            const paymentSuccess = document.querySelector('.payment-success');
            
            // Verify bill was stored properly before proceeding
            const lastBill = localStorage.getItem('lastBill');
            if (!lastBill) {
                console.warn('No bill found in storage when closing payment success');
                // Continue anyway but log the issue
            }
            
            // Fade out the success modal with smooth transition
            paymentSuccess.style.opacity = '0';
            setTimeout(() => {
                paymentSuccess.classList.remove('active');
                paymentSuccess.style.opacity = '1';
                
                // Clear any remaining confetti
                const confetti = document.querySelectorAll('.confetti');
                confetti.forEach(c => c.remove());
                
                // Wait a moment before showing bills section for better UX
                setTimeout(() => {
                    // Show bills section after payment success is closed
                    toggleBillsSection();
                    
                    // Verify bills section is actually visible
                    const billsSection = document.querySelector('.bills-section');
                    if (!billsSection || !billsSection.classList.contains('active')) {
                        console.warn('Bills section not active after toggle');
                        toggleBillsSection(); // Try again if not active
                    }
                    
                    // Filter to show only today's bills by default after payment
                    filterBills('today');
                    
                    // Highlight the newest bill with a subtle animation
                    const firstBill = document.querySelector('.bill-card');
                    if (firstBill) {
                        firstBill.style.animation = 'none';
                        firstBill.classList.add('new-bill'); // Add a class for styling
                        
                        setTimeout(() => {
                            firstBill.style.animation = 'highlightBill 1.5s ease';
                            
                            // Scroll to the first bill if needed
                            firstBill.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                        }, 10);
                        
                        // Add click listener to show bill details
                        firstBill.addEventListener('click', function() {
                            this.classList.toggle('expanded');
                        });
                    } else {
                        console.warn('No bill card found to highlight');
                        // Try to refresh bills display
                        const bills = JSON.parse(localStorage.getItem('bills') || '[]');
                        if (bills.length > 0) {
                            displayBills(bills.filter(bill => {
                                const billDate = new Date(bill.date);
                                const today = new Date();
                                return billDate.toDateString() === today.toDateString();
                            }));
                        }
                    }
                    
                    // Show a confirmation toast that bill is saved
                    showToast('Your bill has been saved and is available in the Bills section', 'success');
                }, 300);
            }, 300);
            
            // Update bills sidebar count
            updateBillsCount();
            
            // Track successful order completion for analytics
            trackOrderCompletion();
            
            // Set a flag to indicate successful payment completion
            localStorage.setItem('paymentCompleted', 'true');
            
            // Schedule a check to verify bills are displayed properly
            setTimeout(verifyBillsDisplayed, 1000);
        }
        
        function verifyBillsDisplayed() {
            // This function ensures bills are properly displayed after payment
            const billsSection = document.querySelector('.bills-section');
            const billsContainer = document.getElementById('bills-container');
            
            if (billsSection && billsSection.classList.contains('active')) {
                // Bills section is active, check if bills are displayed
                if (billsContainer && billsContainer.children.length === 0) {
                    console.warn('Bills section is active but no bills are displayed');
                    
                    // Try to reload bills
                    const bills = JSON.parse(localStorage.getItem('bills') || '[]');
                    if (bills.length > 0) {
                        console.log('Reloading bills display');
                        displayBills(bills.filter(bill => {
                            const billDate = new Date(bill.date);
                            const today = new Date();
                            return billDate.toDateString() === today.toDateString();
                        }));
                    }
                }
            }
        }
        
        function createConfettiEffect() {
            // Create confetti container if it doesn't exist
            let confettiContainer = document.querySelector('.confetti-container');
            if (!confettiContainer) {
                confettiContainer = document.createElement('div');
                confettiContainer.className = 'confetti-container';
                confettiContainer.style.position = 'fixed';
                confettiContainer.style.top = '0';
                confettiContainer.style.left = '0';
                confettiContainer.style.width = '100%';
                confettiContainer.style.height = '100%';
                confettiContainer.style.overflow = 'hidden';
                confettiContainer.style.pointerEvents = 'none';
                confettiContainer.style.zIndex = '9998'; // Just below success animation
                document.body.appendChild(confettiContainer);
            }
            
            // Clear any existing confetti
            confettiContainer.innerHTML = '';
            
            // Colors for confetti - brighter colors for better visibility
            const colors = ['#4CAF50', '#FF5252', '#FFC107', '#2196F3', '#9C27B0', '#3F51B5', '#FF9800', '#00BCD4'];
            
            // Create more confetti pieces for a richer effect
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.position = 'absolute';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-20px'; // Start above the viewport
                confetti.style.animationDuration = Math.random() * 3 + 2 + 's'; // Longer animation
                confetti.style.animationDelay = Math.random() * 2 + 's';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.opacity = Math.random() * 0.5 + 0.5; // More visible
                confetti.style.zIndex = '9997';
                
                // Randomize confetti size - larger for better visibility
                const size = Math.random() * 15 + 8;
                confetti.style.width = size + 'px';
                confetti.style.height = size + 'px';
                
                // Randomize confetti shape
                if (Math.random() > 0.6) {
                    confetti.style.borderRadius = '50%';
                } else if (Math.random() > 0.5) {
                    confetti.style.borderRadius = '2px';
                }
                
                // Add animation
                confetti.style.animation = `confettiFall ${Math.random() * 3 + 2}s linear forwards, confettiSway ${Math.random() * 2 + 2}s ease-in-out infinite alternate`;
                
                confettiContainer.appendChild(confetti);
            }
            
            // Remove confetti after animation completes
            setTimeout(() => {
                const confetti = document.querySelectorAll('.confetti');
                confetti.forEach(c => {
                    c.style.animation = 'fadeOut 0.5s forwards';
                });
                setTimeout(() => {
                    confettiContainer.innerHTML = '';
                }, 500);
            }, 5000);
        }
        
        function trackOrderCompletion() {
            // This function could be expanded to include real analytics in the future
            // For now, just log to console and update order count in localStorage
            
            // Get current order count
            const orderCount = parseInt(localStorage.getItem('totalOrders') || '0');
            
            // Increment and save
            localStorage.setItem('totalOrders', (orderCount + 1).toString());
            
            console.log('Order completed successfully. Total orders:', orderCount + 1);
        }
        
        // Function to update bills count in sidebar
        function updateBillsCount() {
            const billsCount = JSON.parse(localStorage.getItem('bills') || '[]').length;
            const billsItem = document.querySelector('.sidebar-menu-item.bills');
            
            if (billsItem && billsCount > 0) {
                billsItem.innerHTML = `
                    <i class="material-icons">receipt</i>
                    <span>My Bills</span>
                    <span class="bills-badge">${billsCount}</span>
                `;
            }
        }

        function validatePaymentDetails(method) {
            if (method === 'Credit Card' || method === 'Debit Card') {
                const cardNumber = document.getElementById('card-number').value;
                const cardName = document.getElementById('card-name').value;
                const cardExpiry = document.getElementById('card-expiry').value;
                const cardCvv = document.getElementById('card-cvv').value;
                
                if (!cardNumber || !cardName || !cardExpiry || !cardCvv) {
                    showToast('Please fill in all card details', 'error');
                    return false;
                }
                
                if (cardNumber.replace(/\s/g, '').length !== 16) {
                    showToast('Invalid card number', 'error');
                    return false;
                }
                
                if (cardCvv.length < 3) {
                    showToast('Invalid CVV', 'error');
                    return false;
                }
            } else if (method === 'UPI') {
                const upiId = document.getElementById('upi-id').value;
                
                if (!upiId || !upiId.includes('@')) {
                    showToast('Please enter a valid UPI ID', 'error');
                    return false;
                }
            } else if (method === 'Net Banking') {
                const bank = document.getElementById('bank-select').value;
                
                if (!bank || bank === 'select') {
                    showToast('Please select a bank', 'error');
                    return false;
                }
            }
            
            return true;
        }
        
        function showPaymentOption(option) {
            // Hide all payment forms
            document.querySelectorAll('.payment-form').forEach(form => {
                form.style.display = 'none';
            });
            
            // Show selected payment form
            document.getElementById(option + '-form').style.display = 'block';
            
            // Update selected payment method
            document.querySelectorAll('.payment-method').forEach(method => {
                method.classList.remove('selected');
            });
            document.getElementById(option).parentElement.classList.add('selected');
            
            // Ensure the corresponding radio button is checked
            document.getElementById(option).checked = true;
        }

        function toggleAIChat() {
            const chatFrame = document.querySelector('.chatbase-frame');
            chatFrame.classList.toggle('active');
        }

        // Profile section functions
        function toggleProfileSection() {
            const profileSection = document.getElementById('profileSection');
            profileSection.classList.toggle('active');
            loadProfileData();
        }

        function closeProfileSection() {
            const profileSection = document.getElementById('profileSection');
            profileSection.classList.remove('active');
        }

        async function loadProfileData() {
            try {
                const response = await fetch('/api/profile');
                if (response.ok) {
                    const user = await response.json();
                    document.getElementById('profileName').textContent = user.full_name || user.username;
                    document.getElementById('profileEmail').textContent = user.email;
                    document.getElementById('updateFullName').value = user.full_name || '';
                    document.getElementById('updatePhone').value = user.phone || '';
                    document.getElementById('updateAddress').value = user.address || '';
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }

        document.getElementById('updateProfileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                fullName: document.getElementById('updateFullName').value,
                phone: document.getElementById('updatePhone').value,
                address: document.getElementById('updateAddress').value
            };
            
            try {
                const response = await fetch('/api/profile', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    showToast('Profile updated successfully!', 'success');
                    loadProfileData();
                } else {
                    showToast('Failed to update profile', 'error');
                }
            } catch (error) {
                showToast('An error occurred', 'error');
            }
        });

        // Update the profile icon click handler
        document.querySelector('.profile-icon').addEventListener('click', toggleProfileSection);

        function toggleProfileDropdown() {
            const dropdown = document.querySelector('.profile-dropdown');
            dropdown.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.querySelector('.profile-dropdown');
            const profileIcon = document.querySelector('.profile-icon');
            
            if (!profileIcon.contains(event.target) && !dropdown.contains(event.target)) {
                dropdown.classList.remove('active');
            }
        });

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Redirect to login page
                window.location.href = '/logout';
            }
        }
    </script>
</body>
</html>